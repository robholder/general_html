<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<title>nuke_project_installing_openimageio_macos</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<p>
<a href="index.html">index</a>
</p>

<p>
<a href="nuke_index.html">Nuke Index</a>
</p>

<div id="Installing OpenImageIO in Nuke - MacOS"><h1 id="Installing OpenImageIO in Nuke - MacOS" class="header"><a href="#Installing OpenImageIO in Nuke - MacOS">Installing OpenImageIO in Nuke - MacOS</a></h1></div>

<div id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO"><h1 id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO" class="header"><a href="#This is Gemini's summary of what got my system working with Nuke and OpenImageIO">This is Gemini's summary of what got my system working with Nuke and OpenImageIO</a></h1></div>

<div id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4"><h2 id="macOS 15.6.1 on M3, Nuke 16.0v4" class="header"><a href="#This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4">macOS 15.6.1 on M3, Nuke 16.0v4</a></h2></div>

<p>
Ended up with a location with the OpenImageIO stuff to reference, and a launcher script for Nuke.
</p>

<div id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 1: System setup"><h3 id="Part 1: System setup" class="header"><a href="#This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 1: System setup">Part 1: System setup</a></h3></div>

<p>
Install Homebrew: If you haven't already, install the Homebrew package manager.
</p>

<pre sh>
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
</pre>

<p>
Install dependencies: Use Homebrew to install the necessary build tools and libraries.
</p>

<pre sh>
brew install cmake openexr libtiff jpeg-turbo pybind11 opencolorio
</pre>

<p>
Get OpenImageIO source code: Clone the source code from GitHub.
</p>

<pre sh>
cd ~/Documents/Projects/Projects_apps/Nuke
git clone https://github.com/OpenImageIO/oiio.git
</pre>

<div id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 2: Compile OpenImageIO for Nuke"><h3 id="Part 2: Compile OpenImageIO for Nuke" class="header"><a href="#This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 2: Compile OpenImageIO for Nuke">Part 2: Compile OpenImageIO for Nuke</a></h3></div>

<p>
Create a build directory: Use a separate directory for the build process to keep the source clean.
</p>

<pre sh>
cd ~/Documents/Projects/Projects_apps/Nuke/oiio
mkdir build
cd build
</pre>

<p>
Run CMake to configure the build: This command explicitly points CMake to Nuke's Python 3.11, preventing it from defaulting to another version.
</p>

<pre sh>
cmake .. \
    -DPYTHON_EXECUTABLE=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python \
    -DPython_INCLUDE_DIR=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/Frameworks/Python.framework/Versions/3.11/Headers \
    -DPython_LIBRARY=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/Frameworks/Python.framework/Versions/3.11/Python \
    -DCMAKE_INSTALL_PREFIX=$(pwd)/install \
    -DCMAKE_PREFIX_PATH=/opt/homebrew \
    -DOpenImageIO_BUILD_MISSING_DEPS=all
</pre>

<p>
Compile the source code: This will build all components of OpenImageIO.
</p>

<pre sh>
make -j$(sysctl -n hw.ncpu)
</pre>

<p>
Install the compiled files: This copies the compiled binaries, libraries, and Python bindings to the install subdirectory.
</p>

<pre sh>
make install
</pre>

<div id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 3: Fix runtime paths (rpath)"><h3 id="Part 3: Fix runtime paths (rpath)" class="header"><a href="#This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 3: Fix runtime paths (rpath)">Part 3: Fix runtime paths (rpath)</a></h3></div>

<p>
Fix the core OIIO library: Add the custom installation path to the RPATH of the core library.
</p>

<pre sh>
cd ~/Documents/Projects/Projects_apps/Nuke/oiio/build/install/lib
install_name_tool -add_rpath "/Users/&lt;username&gt;/Documents/Projects/Projects_apps/Nuke/oiio/build/install/lib" libOpenImageIO.3.2.0.dylib
</pre>

<p>
Fix the Python binding: Add the custom installation path to the RPATH of the Python binding.
</p>

<pre sh>
cd ~/Documents/Projects/Projects_apps/Nuke/oiio/build/install/lib/python3.11/site-packages/OpenImageIO
install_name_tool -add_rpath "/Users/&lt;username&gt;/Documents/Projects/Projects_apps/Nuke/oiio/build/install/lib" OpenImageIO.cpython-311-darwin.so
</pre>

<div id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 4: Create a Nuke launch script"><h3 id="Part 4: Create a Nuke launch script" class="header"><a href="#This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 4: Create a Nuke launch script">Part 4: Create a Nuke launch script</a></h3></div>

<p>
Create a launch script: This script sets the PYTHONPATH correctly and launches Nuke.
</p>
<pre sh>
#!/bin/sh

export PYTHONPATH="/Users/&lt;username&gt;/Documents/Projects/Projects_apps/Nuke/oiio/build/install/lib/python3.11/site-packages:${PYTHONPATH}"

/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/Nuke16.0v4 "$@"
</pre>

<p>
Save the script as launch_nuke_with_oiio.sh in your Projects_apps/Nuke directory.
</p>

<p>
Make the script executable:
</p>

<pre sh>
cd ~/Documents/Projects/Projects_apps/Nuke
chmod +x launch_nuke_with_oiio.sh
</pre>

<div id="This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 5: Launch Nuke and test"><h3 id="Part 5: Launch Nuke and test" class="header"><a href="#This is Gemini's summary of what got my system working with Nuke and OpenImageIO-macOS 15.6.1 on M3, Nuke 16.0v4-Part 5: Launch Nuke and test">Part 5: Launch Nuke and test</a></h3></div>

<p>
Launch Nuke: Run the launch script from your terminal.
</p>
<pre sh>
./launch_nuke_with_oiio.sh
</pre>

<p>
Run the test code: In Nuke's Script Editor, run the following to verify the installation.
</p>
<pre python>
import OpenImageIO as oiio
print("OpenImageIO version:", oiio.VERSION)
 
# Verify OpenImageIO functionality by reading image info
# (Replace 'path/to/image.exr' with a valid image file)
image_path = "/path/to/your/test_image.exr"
if oiio.ImageInput.open(image_path):
    print(f"Successfully opened {image_path} with OpenImageIO.")
else:
    print(f"Failed to open image: {oiio.geterror()}")
</pre>


<div id="Long Meandering Conversation..."><h1 id="Long Meandering Conversation..." class="header"><a href="#Long Meandering Conversation...">Long Meandering Conversation...</a></h1></div>

<div id="Long Meandering Conversation...-Find Version Of Python in Nuke"><h2 id="Find Version Of Python in Nuke" class="header"><a href="#Long Meandering Conversation...-Find Version Of Python in Nuke">Find Version Of Python in Nuke</a></h2></div>

<p>
Find and confirm Python version and architecture of Nuke's own Python interpreter.
</p>

<p>
In my case, this worked:
</p>
<pre sh>
/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python -c "import sys; print(sys.version); import platform; print(platform.machine())"
</pre>

<p>
My instance returned the following:
</p>
<pre sh>
3.11.7 (remotes/origin/foundry/v3.11.7:88283f3425, Oct  8 2024, 09:50:25) [Clang 14.0.0 (clang-1400.0.29.202)]
arm64
</pre>

<div id="Long Meandering Conversation...-Brew Install OpenImageIO"><h2 id="Brew Install OpenImageIO" class="header"><a href="#Long Meandering Conversation...-Brew Install OpenImageIO">Brew Install OpenImageIO</a></h2></div>
<table>
<tr>
<td>
DIDN'T WORK DUE TO PYENV AND BREW SEEKING LATEST PYTHON VERSION
</td>
</tr>
</table>

<p>
In a Terminal shell/window:
</p>
<pre sh>
brew install openimageio
</pre>

<p>
When complete, find the bindings:
</p>
<pre sh>
brew --prefix openimageio
</pre>

<p>
In my case, it returned the following:
</p>
<pre sh>
/opt/homebrew/opt/openimageio
</pre>

<pre sh>
brew uninstall openimageio
</pre>

<div id="Gemini Circle Back to MY System Issues"><h1 id="Gemini Circle Back to MY System Issues" class="header"><a href="#Gemini Circle Back to MY System Issues">Gemini Circle Back to MY System Issues</a></h1></div>

<div id="Gemini Circle Back to MY System Issues-QUESTION"><h2 id="QUESTION" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION">QUESTION</a></h2></div>

<table>
<tr>
<td>
Ok, this is a mess on my machine. I use Pyenv to manage my python environment. My system is set to the default MacOS python (version 3.9.6). My Nuke is using 3.11.7. Running 'brew install openimageio' seems to have installed it to 3.13 (by reading the terminal lines such as these: /opt/homebrew/lib/python3.13/site-packages/pip/ Why is 'brew' installing to a particular python version? How to I install specifically for Nuke's access? How can I fix this?
</td>
</tr>
</table>

<p>
This is a classic "dependency hell" scenario caused by a mix of system Python, Homebrew Python, and a Python version manager like Pyenv. Here is why this happens and how you can fix it. 
</p>

<div id="Gemini Circle Back to MY System Issues-Why brew installs to a particular Python version"><h2 id="Why brew installs to a particular Python version" class="header"><a href="#Gemini Circle Back to MY System Issues-Why brew installs to a particular Python version">Why brew installs to a particular Python version</a></h2></div>

<p>
Homebrew's philosophy is to manage its own dependencies in a self-contained manner. When you run brew install openimageio, Homebrew finds the latest stable Python it manages (currently 3.13) and installs the Python bindings for OpenImageIO using that version. It does not interact with your Pyenv-managed environments or your macOS system Python, which is intended to prevent conflicts. 
</p>

<div id="Gemini Circle Back to MY System Issues-How to fix this for Nuke 16 (Python 3.11.7)"><h2 id="How to fix this for Nuke 16 (Python 3.11.7)" class="header"><a href="#Gemini Circle Back to MY System Issues-How to fix this for Nuke 16 (Python 3.11.7)">How to fix this for Nuke 16 (Python 3.11.7)</a></h2></div>

<p>
Since Nuke comes with its own isolated Python interpreter, the Homebrew-installed bindings for Python 3.13 are useless to it. You have two primary options: 
</p>

<div id="Gemini Circle Back to MY System Issues-How to fix this for Nuke 16 (Python 3.11.7)-Option 1: The correct (manual) way"><h4 id="Option 1: The correct (manual) way" class="header"><a href="#Gemini Circle Back to MY System Issues-How to fix this for Nuke 16 (Python 3.11.7)-Option 1: The correct (manual) way">Option 1: The correct (manual) way</a></h4></div>
<p>
This approach is more work but is the most robust and avoids all dependency conflicts by compiling OpenImageIO specifically for Nuke's Python.
Uninstall the Homebrew version of OpenImageIO to clean up your system.
</p>

<pre sh>
brew uninstall openimageio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Ensure Nuke's Python version is installed with Pyenv. Nuke 16.0v4 uses Python 3.11.7. If you don't have it installed with Pyenv, do so now.
</p>

<pre sh>
pyenv install 3.11.7
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Get the OpenImageIO source code. Clone the OIIO repository from GitHub.
</p>

<pre sh>
git clone https://github.com/OpenImageIO/oiio.git
cd oiio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Configure and build OIIO with CMake. Crucially, you must explicitly point CMake to use Nuke's Python interpreter for the bindings.
</p>

<pre sh>
# Navigate into a build directory
mkdir build &amp;&amp; cd build

# Run CMake. You may need to specify the path to OpenEXR and other dependencies
# if you don't have them installed system-wide or via Homebrew.
cmake .. -DUSE_PYTHON=On \
    -DPYTHON_EXECUTABLE=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python.app/Contents/MacOS/python \
    -DCMAKE_INSTALL_PREFIX=$(pwd)/install

# Compile and install
make -j$(sysctl -n hw.ncpu)
make install
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Copy the bindings to a known location. Your Python bindings will now be in ./install/python. Copy or move this directory to a permanent, safe location, for example, your .nuke directory.
</p>

<pre sh>
# Assuming your install is in `oiio/build/install`
cp -R oiio/build/install/python/OpenImageIO ~/.nuke/
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Add the path to init.py. Modify your ~/.nuke/init.py to point to the directory where you copied the bindings.
</p>

<pre python>
import sys
sys.path.append("/Users/YourUsername/.nuke/python")
</pre>
<p>
|Use code with caution.}
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION"><h2 id="QUESTION" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION">QUESTION</a></h2></div>

<table>
<tr>
<td>
Where should I make this directory? # Navigate into a build directory mkdir build &amp;&amp; cd build # Run CMake. You may need to specify the path to OpenEXR and other dependencies # if you don't have them installed system-wide or via Homebrew. cmake .. -DUSE_PYTHON=On \ -DPYTHON_EXECUTABLE=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python.app/Contents/MacOS/python \ -DCMAKE_INSTALL_PREFIX=\((pwd)/install # Compile and install make -j\)(sysctl -n hw.ncpu) make install
</td>
</tr>
</table>

<p>
For building software from source, the best practice is to perform an "out-of-source" build. This means you should create the build directory inside the cloned oiio directory. 
</p>

<p>
This keeps the source code tree clean and separate from the temporary build files (such as object files and generated Makefiles). You can easily remove the build directory afterward to clean up everything related to the build process without affecting the original source code. 
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Recommended directory structure"><h4 id="Recommended directory structure" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Recommended directory structure">Recommended directory structure</a></h4></div>

<p>
Assuming you cloned the OpenImageIO source code into a directory named oiio:
Start in your home directory or another location where you store source code for your projects (e.g., ~/source or ~/dev).
</p>

<pre sh>
cd ~/
# If you haven't already:
git clone https://github.com/OpenImageIO/oiio.git
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Navigate into the oiio source directory:
</p>

<pre sh>
cd oiio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Create and enter the build directory:
</p>

<pre sh>
mkdir build
cd build
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Run the CMake command from the build directory: This is where you will execute the command you listed. The .. tells CMake that the source code is in the parent directory (oiio).
</p>

<pre sh>
cmake .. -DUSE_PYTHON=On \
    -DPYTHON_EXECUTABLE=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python.app/Contents/MacOS/python \
    -DCMAKE_INSTALL_PREFIX=$(pwd)/install
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
This configuration will create a temporary build directory at /Users/YourUsername/oiio/build and a finished, local installation directory at /Users/YourUsername/oiio/build/install.
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION"><h2 id="QUESTION" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION">QUESTION</a></h2></div>

<table>
<tr>
<td>
My terminal reports that I don't have cmake.
</td>
</tr>
</table>

<p>
Your terminal is reporting that cmake is not found because it has not yet been installed or its location is not in your shell's PATH. The easiest way to resolve this on macOS is to use Homebrew, the package manager you already have installed. 
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Step 1: Install CMake with Homebrew"><h4 id="Step 1: Install CMake with Homebrew" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Step 1: Install CMake with Homebrew">Step 1: Install CMake with Homebrew</a></h4></div>

<p>
Open your terminal and run the following command to install CMake. 
</p>
<pre sh>
brew install cmake
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Homebrew will download and install CMake, along with any other dependencies it needs. 
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Step 2: Install Xcode Command-line Tools (if prompted)"><h4 id="Step 2: Install Xcode Command-line Tools (if prompted)" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Step 2: Install Xcode Command-line Tools (if prompted)">Step 2: Install Xcode Command-line Tools (if prompted)</a></h4></div>

<p>
Homebrew is smart enough to handle dependencies for you. When you run brew install cmake, it may detect that you are missing the necessary Xcode Command-line Tools, which are required for compiling software. If so, it will display a pop-up window. Click "Install" and follow the prompts to complete the installation. 
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Step 3: Verify the installation"><h4 id="Step 3: Verify the installation" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Step 3: Verify the installation">Step 3: Verify the installation</a></h4></div>

<p>
After the installation finishes, you can verify that CMake is now available and working correctly by checking its version. 
</p>

<pre sh>
cmake --version
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
This should output the version number of the CMake you just installed. 
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Step 4: Continue with the OpenImageIO build"><h4 id="Step 4: Continue with the OpenImageIO build" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Step 4: Continue with the OpenImageIO build">Step 4: Continue with the OpenImageIO build</a></h4></div>

<p>
Once CMake is successfully installed and available in your terminal, you can resume the build process for OpenImageIO:
</p>

<pre sh>
cd ~/oiio/build

cmake .. -DUSE_PYTHON=On \
    -DPYTHON_EXECUTABLE=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python.app/Contents/MacOS/python \
    -DCMAKE_INSTALL_PREFIX=$(pwd)/install

make -j$(sysctl -n hw.ncpu)
make install
</pre>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Key benefits of this approach"><h4 id="Key benefits of this approach" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Key benefits of this approach">Key benefits of this approach</a></h4></div>

<ul>
<li>
<span id="Gemini Circle Back to MY System Issues-QUESTION-Key benefits of this approach-Keeps your source pristine"></span><strong id="Keeps your source pristine">Keeps your source pristine</strong>: You can later delete the build directory entirely without touching the original downloaded source code.

<li>
<span id="Gemini Circle Back to MY System Issues-QUESTION-Key benefits of this approach-Reduces clutter"></span><strong id="Reduces clutter">Reduces clutter</strong>: Object files, log files, and other generated content are all contained within a single build directory.

<li>
<span id="Gemini Circle Back to MY System Issues-QUESTION-Key benefits of this approach-Prevents rebuild issues"></span><strong id="Prevents rebuild issues">Prevents rebuild issues</strong>: It avoids potential conflicts that can arise when CMake tries to reconfigure an "in-source" build.

</ul>
<div id="Gemini Circle Back to MY System Issues-QUESTION"><h2 id="QUESTION" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION">QUESTION</a></h2></div>

<table>
<tr>
<td>
What do I need to do to satisfy these specifications: You may need to specify the path to OpenEXR and other dependencies # if you don't have them installed system-wide or via Homebrew.
</td>
</tr>
</table>

<p>
For your specific setup on macOS (Apple Silicon M3) using Homebrew, satisfying the dependencies for OpenImageIO is most cleanly done by installing them via Homebrew first, since it is a system-level build tool. This will put the dependency files in a standard location where CMake can easily find them. 
</p>

<p>
Here is a step-by-step process to ensure OpenEXR and other necessary dependencies are available before you run your build command. 
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Step 1: Install dependencies with Homebrew"><h4 id="Step 1: Install dependencies with Homebrew" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Step 1: Install dependencies with Homebrew">Step 1: Install dependencies with Homebrew</a></h4></div>

<p>
Open your terminal and run the following command to install the primary dependencies for OpenImageIO. These are typically required, while others like OpenColorIO and WebP are optional depending on your needs. 
</p>

<pre sh>
brew install openexr libtiff jpeg-turbo opencolorio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Step 2: Verify Homebrew installation paths"><h4 id="Step 2: Verify Homebrew installation paths" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Step 2: Verify Homebrew installation paths">Step 2: Verify Homebrew installation paths</a></h4></div>

<p>
To be certain where Homebrew installed these dependencies, you can use the brew --prefix command. For an Apple Silicon machine, the path should be /opt/homebrew. 
</p>

<pre sh>
brew --prefix
# Expected output: /opt/homebrew
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Homebrew automatically links the headers and libraries into this prefix, which is a standard search location for CMake.
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Step 3: Run the CMake command with CMAKE_PREFIX_PATH"><h4 id="Step 3: Run the CMake command with CMAKE_PREFIX_PATH" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Step 3: Run the CMake command with CMAKE_PREFIX_PATH">Step 3: Run the CMake command with CMAKE_PREFIX_PATH</a></h4></div>

<p>
While CMake is often smart enough to find Homebrew-installed packages automatically, explicitly setting CMAKE_PREFIX_PATH is a robust way to ensure it finds everything correctly, especially if you have other tools installed that might cause conflicts. 
</p>

<p>
From within your ~/oiio/build directory, run the cmake command again. This time, include the path to your Homebrew prefix using the CMAKE_PREFIX_PATH variable. 
</p>

<pre sh>
cmake .. \
    -DUSE_PYTHON=On \
    -DPYTHON_EXECUTABLE=/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python.app/Contents/MacOS/python \
    -DCMAKE_INSTALL_PREFIX=$(pwd)/install \
    -DCMAKE_PREFIX_PATH=/opt/homebrew
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<div id="Gemini Circle Back to MY System Issues-QUESTION-Explanation of the command"><h4 id="Explanation of the command" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-Explanation of the command">Explanation of the command</a></h4></div>
<ul>
<li>
-DCMAKE_PREFIX_PATH=/opt/homebrew: This is the crucial part that tells CMake to search for its dependencies within the Homebrew installation. This is where OpenEXR, libTIFF, and other packages were installed.

<li>
The rest of the command remains the same, specifying the Python executable and the local install directory. 

</ul>
<div id="Gemini Circle Back to MY System Issues-QUESTION-What to do if CMake still fails"><h4 id="What to do if CMake still fails" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION-What to do if CMake still fails">What to do if CMake still fails</a></h4></div>

<p>
If CMake still fails to find a dependency, there may be an issue with a specific package. In this case, you can provide CMake with a more specific path using a variable like OPENEXR_ROOT. 
</p>

<p>
First, find the install location of the specific package, e.g., openexr:
</p>

<pre sh>
brew --prefix openexr
# This will output something like: /opt/homebrew/opt/openexr
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Then, add the corresponding CMake variable to your build command: 
</p>

<pre sh>
cmake .. \
    ...
    -DOPENEXR_ROOT=$(brew --prefix openexr)
    ...
</pre>
<p>
Use code with caution.
</p>

<p>
By following these steps, you can successfully build OpenImageIO with its necessary dependencies on macOS.
</p>

<div id="Gemini Circle Back to MY System Issues-Option 2: The hacky (but easier) way"><h2 id="Option 2: The hacky (but easier) way" class="header"><a href="#Gemini Circle Back to MY System Issues-Option 2: The hacky (but easier) way">Option 2: The hacky (but easier) way</a></h2></div>

<p>
This method relies on creating a hard link to the Homebrew-installed bindings and is less robust but requires less effort. It works because Homebrew installs the binaries in a way that is compatible with Apple Silicon.
Find the installed OIIO bindings. You can find the path by inspecting the Homebrew installation.
</p>

<pre sh>
brew info openimageio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Look for a line mentioning the installation path, which typically contains a python3.13 subdirectory. Example: /opt/homebrew/lib/python3.13/site-packages/OpenImageIO.so.
</p>

<p>
Determine Nuke's site-packages location. Open the Nuke Script Editor and run:
</p>

<pre python>
import site
print(site.getsitepackages())
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
The output should be the path you need to copy the bindings to. Example: /Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python.app/Contents/Resources/lib/python3.11/site-packages.
</p>

<p>
Copy the OpenImageIO bindings. Copy the .so file from Homebrew's install directory to Nuke's site-packages.
</p>

<pre sh>
# Note: Use `cp` to copy, not link, to avoid breaking it with Homebrew updates.
cp /opt/homebrew/lib/python3.13/site-packages/OpenImageIO.so \
"/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python.app/Contents/Resources/lib/python3.11/site-packages/"
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<div id="Gemini Circle Back to MY System Issues-Recommendation"><h2 id="Recommendation" class="header"><a href="#Gemini Circle Back to MY System Issues-Recommendation">Recommendation</a></h2></div>

<p>
For production stability, Option 1 (building from source) is the recommended approach. It guarantees that the OpenImageIO bindings are compiled specifically for Nuke's Python 3.11.7 interpreter, eliminating any potential version incompatibilities or future issues caused by Homebrew updates. It also ensures you don't break any of your existing Python environments managed by Pyenv.
</p>

<div id="Gemini Circle Back to MY System Issues-QUESTION"><h2 id="QUESTION" class="header"><a href="#Gemini Circle Back to MY System Issues-QUESTION">QUESTION</a></h2></div>
<table>
<tr>
<td>
So how do I install things into the system Python version on MacOS with Homebrew? In my experience I thought it installed into the currently active Python.
</td>
</tr>
</table>

<p>
This is a very important clarification: you cannot use Homebrew to install packages into the macOS system Python.. Homebrew and the macOS system Python are intentionally isolated from each other. 
</p>

<p>
Here's a breakdown of why this happens and what you need to do instead.
</p>

<div id="Gemini Circle Back to MY System Issues-Why Homebrew doesn't install to system Python"><h2 id="Why Homebrew doesn't install to system Python" class="header"><a href="#Gemini Circle Back to MY System Issues-Why Homebrew doesn't install to system Python">Why Homebrew doesn't install to system Python</a></h2></div>

<p>
Homebrew and macOS's system integrity protections prevent Homebrew from touching system-managed components, which is a good thing for stability.
</p>
<ul>
<li>
<span id="Gemini Circle Back to MY System Issues-Why Homebrew doesn't install to system Python-Avoids breakage"></span><strong id="Avoids breakage">Avoids breakage</strong>: Homebrew is an unprivileged package manager. It cannot and should not modify core system files or software like Python, which macOS relies on. If Homebrew were to break the system Python, it could cause system-wide issues.

<li>
<span id="Gemini Circle Back to MY System Issues-Why Homebrew doesn't install to system Python-Independent updates"></span><strong id="Independent updates">Independent updates</strong>: Homebrew updates its own managed Python versions (like 3.13) independently of macOS system updates. This prevents a Homebrew update from accidentally breaking scripts or applications that depend on the system Python.

<li>
<span id="Gemini Circle Back to MY System Issues-Why Homebrew doesn't install to system Python-Multiple versions"></span><strong id="Multiple versions">Multiple versions</strong>: Homebrew is designed to manage and install its own dependencies, including Python itself. When you run brew install openimageio, it sees that OIIO needs Python bindings, so it uses the latest Python version it manages (e.g., python@3.13) to build and install them. 

</ul>
<div id="Gemini Circle Back to MY System Issues-Why brew install doesn't use your active Python environment"><h2 id="Why brew install doesn't use your active Python environment" class="header"><a href="#Gemini Circle Back to MY System Issues-Why brew install doesn't use your active Python environment">Why brew install doesn't use your active Python environment</a></h2></div>

<p>
Your active Python environment is managed by Pyenv, which is outside of Homebrew's control. Homebrew does not interact with Python version managers like Pyenv, virtual environments (venv), or your system Python. Your shell's PATH environment variable determines which python executable is active, but that doesn't affect Homebrew's internal build process. 
</p>

<p>
When you run brew install &lt;package&gt;, Homebrew:
</p>
<ul>
<li>
Downloads the formula for that package.

<li>
Determines its own set of dependencies.

<li>
Installs those dependencies using its own rules, completely ignoring your current shell configuration and active Python environment. 

</ul>
<div id="Gemini Circle Back to MY System Issues-The correct path forward for Nuke"><h2 id="The correct path forward for Nuke" class="header"><a href="#Gemini Circle Back to MY System Issues-The correct path forward for Nuke">The correct path forward for Nuke</a></h2></div>

<p>
Your situation is complicated by three separate Python interpreters:
</p>
<ul>
<li>
macOS System Python (3.9.6): Cannot be modified by Homebrew.

<li>
Pyenv Python (various): Managed separately.

<li>
Nuke Python (3.11.7): A third, independent interpreter. 

</ul>
<p>
Since Nuke 16.0v4 uses a specific and isolated Python version (3.11.7), your approach must focus on getting the OIIO bindings into Nuke's environment specifically.
</p>

<p>
As outlined in the previous response, the most robust and stable method is to build OpenImageIO from source specifically for Nuke's Python interpreter. This avoids all the conflicts and guarantees compatibility. 
</p>

<p>
Alternatively, the "hacky" method involves copying the .so bindings from Homebrew's install location to Nuke's internal Python site-packages directory. However, this is fragile and not recommended for production. 
</p>

<p>
The core takeaway is to stop trying to use Homebrew to manage dependencies for environments it isn't designed for (i.e., your system Python and Nuke's bundled Python).
</p>

<div id="BACK TO INITIAL CONVERSATION"><h1 id="BACK TO INITIAL CONVERSATION" class="header"><a href="#BACK TO INITIAL CONVERSATION">BACK TO INITIAL CONVERSATION</a></h1></div>
<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS"><h1 id="Gemini Response to Installing OpenImageIO for Nuke on MacOS" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS">Gemini Response to Installing OpenImageIO for Nuke on MacOS</a></h1></div>

<p>
Setting up OpenImageIO (OIIO) for Nuke 16 on an Apple Silicon (M3) Mac requires compiling the Python bindings for the correct architecture and making them available to Nuke's internal Python environment. Using Homebrew is the easiest method for a streamlined build process. 
</p>

<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin"><h2 id="Before you begin" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin">Before you begin</a></h2></div>

<ul>
<li>
<span id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Install Homebrew"></span><strong id="Install Homebrew">Install Homebrew</strong>: If you don't already have it, install the Homebrew package manager by running this command in your terminal:
<pre sh>
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<li>
<span id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Ensure Command-line Tools"></span><strong id="Ensure Command-line Tools">Ensure Command-line Tools</strong>: Make sure you have the Xcode Command-line Tools, which are necessary for compiling. Homebrew will prompt you to install them if they are missing.

<li>
<span id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Find Nuke's Python executable"></span><strong id="Find Nuke's Python executable">Find Nuke's Python executable</strong>: Nuke on macOS bundles its own Python interpreter. For Nuke 16.0v4, it is located at:

</ul>
  
<pre sh>
/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python
</pre>

<p>
Confirm Python version and architecture: Run Nuke's Python executable with the following command to check its version and architecture.
</p>

<pre sh>
/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/python -c "import sys; print(sys.version); import platform; print(platform.machine())"
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
This should return 3.11 as the version and arm64 as the machine architecture. 
</p>

<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 1: Install OpenImageIO using Homebrew"><h3 id="Step 1: Install OpenImageIO using Homebrew" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 1: Install OpenImageIO using Homebrew">Step 1: Install OpenImageIO using Homebrew</a></h3></div>

<p>
Homebrew's openimageio formula has built-in support for Apple Silicon, which greatly simplifies the installation. 
Install OpenImageIO: Open your terminal and run the following command to install OIIO along with its required dependencies like OpenEXR and OpenColorIO.
</p>

<pre sh>
brew install openimageio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<ul>
<li>
<span id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 1: Install OpenImageIO using Homebrew-Find the installed Python bindings"></span><strong id="Find the installed Python bindings">Find the installed Python bindings</strong>: Homebrew will place the Python bindings in a standard location. You can find this path by running:

</ul>
  
<pre sh>
brew --prefix openimageio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
The Python libraries will be in a subdirectory like /opt/homebrew/lib/python3.11/site-packages.
</p>

<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment"><h3 id="Step 2: Configure Nuke's Python environment" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment">Step 2: Configure Nuke's Python environment</a></h3></div>

<p>
There are two ways to add the OIIO Python bindings to Nuke's environment.
</p>

<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Option 1: Use PYTHONPATH in a shell script"><h4 id="Option 1: Use PYTHONPATH in a shell script" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Option 1: Use PYTHONPATH in a shell script">Option 1: Use PYTHONPATH in a shell script</a></h4></div>

<p>
This is the most reliable method for launching Nuke with custom libraries.
</p>

<p>
Create a shell script, for example launch_nuke.sh, with the following content:
</p>

<pre sh>
#!/bin/sh

# Path to the OIIO site-packages installed by Homebrew
export OIIO_PYTHON_PATH="/opt/homebrew/lib/python3.11/site-packages"

# Append the OIIO path to PYTHONPATH
export PYTHONPATH="${OIIO_PYTHON_PATH}:${PYTHONPATH}"

# Launch Nuke
/Applications/Nuke16.0v4/Nuke16.0v4.app/Contents/MacOS/Nuke16.0v4 "$@"
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Make the script executable:
</p>

<pre sh>
chmod +x launch_nuke.sh
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Launch Nuke from the script:"><h4 id="Launch Nuke from the script:" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Launch Nuke from the script:">Launch Nuke from the script:</a></h4></div>

<pre sh>
./launch_nuke.sh
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Option 2: Modify Nuke's init.py"><h4 id="Option 2: Modify Nuke's init.py" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Option 2: Modify Nuke's init.py">Option 2: Modify Nuke's init.py</a></h4></div>

<p>
This will automatically configure the path every time Nuke starts, without a custom launcher. 
Navigate to your Nuke user directory in the terminal:
</p>

<pre sh>
cd ~/.nuke
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Open the init.py file in a text editor. If it doesn't exist, create it.
</p>

<pre sh>
open -a "TextEdit" init.py
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Add the following Python code to the file, making sure the path is correct for your Homebrew installation:
</p>

<pre python>
import sys

# Add the Homebrew Python site-packages directory to Nuke's Python path
sys.path.append("/opt/homebrew/lib/python3.11/site-packages")
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<div id="Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Step 3: Test the installation in Nuke"><h4 id="Step 3: Test the installation in Nuke" class="header"><a href="#Gemini Response to Installing OpenImageIO for Nuke on MacOS-Before you begin-Step 2: Configure Nuke's Python environment-Step 3: Test the installation in Nuke">Step 3: Test the installation in Nuke</a></h4></div>

<p>
Launch Nuke using one of the methods above.
</p>

<p>
In the Script Editor, run this code to verify the installation.
</p>

<pre python>
import OpenImageIO as oiio
print("OpenImageIO version:", oiio.VERSION)

# Verify OpenImageIO functionality by reading image info
# (Replace 'path/to/image.exr' with a valid image file)
image_path = "/path/to/your/test_image.exr"
if oiio.ImageInput.open(image_path):
    print(f"Successfully opened {image_path} with OpenImageIO.")
else:
    print(f"Failed to open image: {oiio.geterror()}")
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
If the script prints the OIIO version number and the test is successful, your installation is working correctly.
</p>

<div id="Uninstall OpenImageIO"><h1 id="Uninstall OpenImageIO" class="header"><a href="#Uninstall OpenImageIO">Uninstall OpenImageIO</a></h1></div>

<p>
To uninstall OpenImageIO after installing it with Homebrew, you will need to run a few simple commands in your terminal. This process removes the OIIO files and any unnecessary dependencies that were installed alongside it. 
</p>

<div id="Uninstall OpenImageIO-Step 1: Uninstall OpenImageIO"><h2 id="Step 1: Uninstall OpenImageIO" class="header"><a href="#Uninstall OpenImageIO-Step 1: Uninstall OpenImageIO">Step 1: Uninstall OpenImageIO</a></h2></div>
<p>
Open your terminal and run the brew uninstall command, specifying openimageio as the package you want to remove. 
</p>

<pre sh>
brew uninstall openimageio
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Homebrew will then proceed to remove the OpenImageIO files from your system.
</p>

<div id="Uninstall OpenImageIO-Step 2: Remove unused dependencies"><h2 id="Step 2: Remove unused dependencies" class="header"><a href="#Uninstall OpenImageIO-Step 2: Remove unused dependencies">Step 2: Remove unused dependencies</a></h2></div>

<p>
When you installed OpenImageIO, Homebrew also installed its dependencies (e.g., libraries like OpenEXR and OpenColorIO). Some of these dependencies may not be required by other packages on your system. You can automatically remove any of these orphaned dependencies using the brew autoremove command. 
</p>

<pre sh>
brew autoremove
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
Note: Since May 2024, brew autoremove is automatically run for you when you uninstall a package. It's still good practice to run it manually to ensure a clean system. 
</p>

<div id="Uninstall OpenImageIO-Step 3: Clean up residual files"><h2 id="Step 3: Clean up residual files" class="header"><a href="#Uninstall OpenImageIO-Step 3: Clean up residual files">Step 3: Clean up residual files</a></h2></div>

<p>
Even after uninstalling a package, Homebrew keeps old downloads in its cache and can leave behind old versions of formulae. You can clean these up to free up disk space by running brew cleanup. 
</p>

<pre sh>
brew cleanup
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<p>
To see what brew cleanup would remove without actually deleting anything, you can add the --dry-run flag. 
</p>

<pre sh>
brew cleanup --dry-run
</pre>
<table>
<tr>
<td>
Use code with caution.
</td>
</tr>
</table>

<div id="Uninstall OpenImageIO-Step 4: Undo your Nuke configuration (optional)"><h2 id="Step 4: Undo your Nuke configuration (optional)" class="header"><a href="#Uninstall OpenImageIO-Step 4: Undo your Nuke configuration (optional)">Step 4: Undo your Nuke configuration (optional)</a></h2></div>

<p>
If you set up your Nuke environment to find the OIIO installation, you should undo those changes to avoid future errors.
</p>
<ul>
<li>
If you used a launch script: Stop using the custom launch_nuke.sh and simply launch Nuke directly from its application icon.

<li>
If you modified init.py: Edit the init.py file in your ~/.nuke directory and remove the line you added.

</ul>
  
<pre python>
import sys
# Remove this line to undo the change
# sys.path.append("/opt/homebrew/lib/python3.11/site-packages")
</pre>


<p>
<a href="nuke_index.html">Nuke Index</a>
</p>

<p>
<a href="index.html">index</a>
</p>

</body>
</html>
