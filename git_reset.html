<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<title>git_reset</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<p>
<a href="index.html">index</a>
</p>

<p>
<a href="Git.html">Git</a>
</p>

<div id="Reset"><h1 id="Reset" class="header"><a href="#Reset">Reset</a></h1></div>

<p>
<span id="Reset-Reset"></span><strong id="Reset">Reset</strong> acts on a whole commit. (If a file is given, it is unstaged.)<br>
The <span id="Reset-Restore"></span><strong id="Restore">Restore</strong> command acts on files (elements)<br>
</p>

<p>
<span id="Reset-Reset"></span><strong id="Reset">Reset</strong> <em>changes</em> the commit history and moves the HEAD.<br>
The <span id="Reset-Restore"></span><strong id="Restore">Restore</strong> command does not affect the history-line.<br>
</p>


<div id="Reset-Reset - Resetting to a Commit"><h3 id="Reset - Resetting to a Commit" class="header"><a href="#Reset-Reset - Resetting to a Commit">Reset - Resetting to a Commit</a></h3></div>
<div id="Reset-Reset - Resetting to a Commit---mixed (default mode)"><h4 id="--mixed (default mode)" class="header"><a href="#Reset-Reset - Resetting to a Commit---mixed (default mode)">--mixed (default mode)</a></h4></div>
<pre bash>
git reset HEAD~1                # Go back to HEAD~1 (previous) commit

# The working file is untouched at this point, and the staged has also been reset to the previous commit
git diff &lt;file&gt;                 # Working and staged are now different
git diff --staged &lt;file&gt;        # Staged and Committed are the same (both the reset version)
get restore &lt;file&gt;              # Now the working file has been restored to the commit
</pre>

<p>
B (commit)<br>
|<br>
A (commit)<br>
</p>

<p>
Initial Status:
<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
B
</td>
<td>
B
</td>
<td>
B
</td>
</tr>
</table>
$ git reset HEAD~1
</p>
 
<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
B
</td>
<td>
A
</td>
<td>
A
</td>
</tr>
</table>

<div id="Reset-Reset - Resetting to a Commit-Follow with 'restore' to have all domains reset"><h4 id="Follow with 'restore' to have all domains reset" class="header"><a href="#Reset-Reset - Resetting to a Commit-Follow with 'restore' to have all domains reset">Follow with 'restore' to have all domains reset</a></h4></div>

<p>
$ git restore &lt;file&gt;
</p>
 
<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
A
</td>
<td>
A
</td>
<td>
A
</td>
</tr>
</table>

<div id="Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')"><h3 id="Reset - Resetting to a Commit (and moving the deleted commit to 'staged')" class="header"><a href="#Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')">Reset - Resetting to a Commit (and moving the deleted commit to 'staged')</a></h3></div>

<div id="Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')---soft"><h4 id="--soft" class="header"><a href="#Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')---soft">--soft</a></h4></div>
<pre bash>
git reset --soft HEAD~1         # Go back to HEAD~1 (previous) commit and move current commit to 'staged'
git diff --staged               # Staged now holds the versions from the 'deleted' commit
git restore --staged &lt;file&gt;     # Removes staged differences (now it's the same as the 'reset' commit)
git restore &lt;file&gt;              # Removes working file differences
</pre>

<p>
B (commit)<br>
|<br>
A (commit)<br>
</p>

<p>
Initial Status:
<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
B
</td>
<td>
B
</td>
<td>
B
</td>
</tr>
</table>
$ git reset --soft HEAD~1
</p>
 

<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
B
</td>
<td>
B
</td>
<td>
A
</td>
</tr>
</table>


<div id="Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')-Follow with 'restore --staged' to have index reset"><h4 id="Follow with 'restore --staged' to have index reset" class="header"><a href="#Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')-Follow with 'restore --staged' to have index reset">Follow with 'restore --staged' to have index reset</a></h4></div>
<p>
$ git restore --staged &lt;file&gt;
</p>

<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
B
</td>
<td>
A
</td>
<td>
A
</td>
</tr>
</table>


<div id="Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')-Follow with 'restore' to have all domains reset"><h4 id="Follow with 'restore' to have all domains reset" class="header"><a href="#Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')-Follow with 'restore' to have all domains reset">Follow with 'restore' to have all domains reset</a></h4></div>
<p>
$ git restore &lt;file&gt;
</p>

<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
A
</td>
<td>
A
</td>
<td>
A
</td>
</tr>
</table>

<div id="Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')"><h3 id="Reset - Resetting to a Commit (and moving the deleted commit to 'staged')" class="header"><a href="#Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')">Reset - Resetting to a Commit (and moving the deleted commit to 'staged')</a></h3></div>

<div id="Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')---hard"><h4 id="--hard" class="header"><a href="#Reset-Reset - Resetting to a Commit (and moving the deleted commit to 'staged')---hard">--hard</a></h4></div>

<pre bash>
git reset --hard HEAD~1         # Go back to HEAD~1 (previous) commit and move current commit to 'staged' AND working
git diff &lt;file&gt;                 # Working and staged are both the previous commit
git diff --staged &lt;file&gt;        # Staged now holds the reset commit versions
</pre>

<p>
B (commit)<br>
|<br>
A (commit)<br>
</p>

<p>
Initial Status:
<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
B
</td>
<td>
B
</td>
<td>
B
</td>
</tr>
</table>
$ git reset --hard HEAD~1
</p>
 

<table>
<tr>
<td>
working
</td>
<td>
staged/index
</td>
<td>
commit
</td>
</tr>
<tr>
<td>
A
</td>
<td>
A
</td>
<td>
A
</td>
</tr>
</table>

<div id="Reset-Pushing a Reset to Origin/Remote"><h2 id="Pushing a Reset to Origin/Remote" class="header"><a href="#Reset-Pushing a Reset to Origin/Remote">Pushing a Reset to Origin/Remote</a></h2></div>
<pre bash>
# To force the reset HEAD (deletion of commit) to a remote repo:
git push --force origin
</pre>
<div id="Reset-Pushing a Reset to Origin/Remote-Looking at git diff"><h3 id="Looking at git diff" class="header"><a href="#Reset-Pushing a Reset to Origin/Remote-Looking at git diff">Looking at git diff</a></h3></div>
<pre bash>

vim &lt;file&gt;                      # "commit"
git add &lt;file&gt;
git commit -m "message 1"
vim &lt;file&gt;                      # "commit .. staged"
git add &lt;file&gt;
vim &lt;file&gt;                      # "commit .. staged .. working"

git diff &lt;file&gt;                 # This shows difference between working and staged
git diff --staged &lt;file&gt;        # This shows difference between staged and commit

</pre>

<div id="Reset-Pushing a Reset to Origin/Remote-Testing"><h3 id="Testing" class="header"><a href="#Reset-Pushing a Reset to Origin/Remote-Testing">Testing</a></h3></div>

<pre bash>
vim &lt;file new&gt;                  # created and populated file
git add &lt;file new&gt;              # stage/index the file
git restore --staged &lt;file new&gt; # unstage
git status                      # result shows that the file hasn't been staged

git add &lt;file new&gt;              # re-stage/re-index the file

vim &lt;file new&gt;                  # edit the file

git diff                        # shows difference between working and staged/index file

git status
On branch main
Changes to be committed:                                # This is the staged/indexed file
  (use "git restore --staged &lt;file&gt;..." to unstage)
	new file:   five.txt

Changes not staged for commit:                          # This is the working file (edited)
  (use "git add &lt;file&gt;..." to update what will be committed)
  (use "git restore &lt;file&gt;..." to discard changes in working directory)
	modified:   five.txt

git restore --staged &lt;file new&gt; # Staged file is deleted - the working tree file is unchanged

git add &lt;file new&gt;
git commit -m "message"

vim &lt;file new&gt;                  # make a change on the working tree

git diff &lt;file new&gt;             # now shows diff between working tree and commit. (There's no staged file.)
git add &lt;file new&gt;
git diff &lt;file new&gt;             # now shows no difference between working and staged
git diff --staged               # shows difference between staged and commit
git commit -m "message 2"       # new commit (leaving nothing in stage)
vim &lt;file new&gt;                  # edit file in working tree.
git diff &lt;file new&gt;             # shows difference between working and commit

</pre>

<p>
<a href="Git.html">Git</a>
</p>

<p>
<a href="index.html">index</a>
</p>

</body>
</html>
