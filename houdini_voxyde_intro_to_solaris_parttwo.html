<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<title>houdini_voxyde_intro_to_solaris_parttwo</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<p>
<a href="index.html">index</a>
</p>

<p>
<a href="Houdini.html">Houdini</a>
</p>

<div id="Voxyde - Intro to Solaris - Part Two - the build"><h1 id="Voxyde - Intro to Solaris - Part Two - the build" class="header"><a href="#Voxyde - Intro to Solaris - Part Two - the build">Voxyde - Intro to Solaris - Part Two - the build</a></h1></div>
<div id="Voxyde - Intro to Solaris - Part Two - the build-[[https://www.youtube.com/watch?v=3BX97YIQERE|YouTube - Voxyde - Intro to Solaris]]"><h4 id="[[https://www.youtube.com/watch?v=3BX97YIQERE|YouTube - Voxyde - Intro to Solaris]]" class="header"><a href="#Voxyde - Intro to Solaris - Part Two - the build-[[https://www.youtube.com/watch?v=3BX97YIQERE|YouTube - Voxyde - Intro to Solaris]]"><a href="https://www.youtube.com/watch?v=3BX97YIQERE">YouTube - Voxyde - Intro to Solaris</a></a></h4></div>

<div id="Initial Layout &amp; Camera"><h1 id="Initial Layout &amp; Camera" class="header"><a href="#Initial Layout &amp; Camera">Initial Layout &amp; Camera</a></h1></div>
<div id="Initial Layout &amp; Camera-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=6495s|YouTube - timecode: 01:48:15]]"><h4 id="[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=6495s|YouTube - timecode: 01:48:15]]" class="header"><a href="#Initial Layout &amp; Camera-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=6495s|YouTube - timecode: 01:48:15]]"><a href="https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=6495s">YouTube - timecode: 01:48:15</a></a></h4></div>

<div id="A Scene Build to Show One Solaris Workflow"><h1 id="A Scene Build to Show One Solaris Workflow" class="header"><a href="#A Scene Build to Show One Solaris Workflow">A Scene Build to Show One Solaris Workflow</a></h1></div>

<div id="A Scene Build to Show One Solaris Workflow-Ground"><h2 id="Ground" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Ground">Ground</a></h2></div>

<div id="A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs"><h3 id="Start building in SOPs" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs">Start building in SOPs</a></h3></div>

<p>
Start in <code>SOPS</code> (<code>N</code> in Network Editor and choose 'Objects')
</p>

<ul>
<li>
Drop a <code>Grid</code> and rename 'geo_ground'.

<li>
Drop a <code>Tommy</code> for scale

</ul>
<p>
Jump into the Grid container (set 'show all objects' in the viewport).
</p>

<ul>
<li>
Increase grid size to 100 x 100

<li>
Rows/Columns to 250 x 250 (to have more resolution for landscape)

</ul>
<div id="A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs-Create curve to define 'river'"><h4 id="Create curve to define 'river'" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs-Create curve to define 'river'">Create curve to define 'river'</a></h4></div>
 
<ul>
<li>
Drop a <code>Draw Curve</code> node (not a 'Curve' node, and not connected to the grid):

<ul>
<li>
Projection drop-down: <code>ZX Plane</code>

<li>
Template the grid geo

<li>
<code>Enter</code> key in viewport

<li>
<code>LMB</code> drag to draw an 'S' shape across the grid surface (for a river's path)

</ul>
<li>
Drop a <code>Resample</code> node:

<ul>
<li>
Length to 24

</ul>
<li>
Drop a <code>Convert</code> node:

<ul>
<li>
'Convert To' <code>NURBS Curve</code>

</ul>
<li>
Drop a <code>Curve</code> node:

<ul>
<li>
<code>Enter</code> in the viewport and select <code>F</code> key to edit the curve if required.

</ul>
<li>
Drop a <code>Resample</code> node:

<li>
Drop a <code>Transform</code> node:

<ul>
<li>
Set <code>Y</code> scale to zero

</ul>
<li>
Drop a <code>Color</code> node:

<ul>
<li>
Set to a white color

</ul>
<li>
Add a <code>Null</code> and rename to 'curve'

</ul>
<div id="A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs-Back on the Grid"><h4 id="Back on the Grid" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs-Back on the Grid">Back on the Grid</a></h4></div>

<p>
Now start to build from the original grid geo:
</p>
<ul>
<li>
Drop a <code>Color</code> node:

<ul>
<li>
set to a black color

</ul>
<li>
Add a <code>Null</code> and rename to 'grid'

<li>
<code>Attribute Transfer</code> node:

<ul>
<li>
connect the grid chain to the left input

<li>
connect the curve chain to the right input

<li>
Attributes tab:

<ul>
<li>
Leave only <code>Points</code> checked and enter <code>Cd</code> as attribute in the field.

</ul>
<li>
Conditions tab:

<ul>
<li>
Set <code>Kernel Function</code> to 'Blinn model' (these are just different 'looks')

<li>
Check on <code>Distance Treshold</code> and set to 2.13

<li>
Adjust the <code>Blend Width</code> attribute (11)

</ul>
</ul>
<li>
Add an <code>Attribute VOP</code>:

<ul>
<li>
rename to 'push_down'

<li>
Inside the node:

<ul>
<li>
<code>P</code> input to a <code>Subtract</code> node

<li>
From its <code>diff</code> output, plug into the overall <code>P</code> output 

<li>
Connect the 'Cd' to a <code>Vector to Float</code> node

<li>
Connect this to a <code>Float to Vector</code> node (2nd input for <code>Y</code> component):

<ul>
<li>
Connect the <code>vec</code> output to the <code>Subtract</code> input 2

<li>
Drop a <code>Multiply</code> node between to scale the river trough:

<ul>
<li>
Promote the input2 as a control

<li>
Label field to <code>Push amount</code> (click on input plug and change 'Label' field in the parameter pane)

</ul>
</ul>
</ul>
</ul>
<li>
After the <code>Attribute VOP</code> add another <code>Color</code> node set to white (to clear the painted sweep)

</ul>
<p>
The cool thing about this approach is that you can still edit the curve to adjust the river path!!
</p>

<div id="A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs-Add noise and finish up Ground"><h4 id="Add noise and finish up Ground" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Ground-Start building in SOPs-Add noise and finish up Ground">Add noise and finish up Ground</a></h4></div>

<ul>
<li>
Now add a <code>Mountain</code> node (it's an 'attribute noise' nodeo) after the 'Color' node:

<ul>
<li>
In the 'Noise Pattern' section of its parameters:

<ul>
<li>
<code>Element Size</code> to around 6.71

<li>
<code>Amplitude</code> to 0.67

</ul>
</ul>
<li>
Add a <code>Transform</code> node, and Translate 1.5 in <code>Y</code>

<li>
Add a <code>Null</code> and rename to 'OUT_geo_ground'

</ul>
<p>
Network Editor diagram:
</p>
<pre>
                                   ┌────────────────┐                    
                                   │  DRAW CURVE    │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │     EDIT       │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │    RESAMPLE    │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │    CONVERT     │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │     CURVE      │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │   RESAMPLE     │                    
                                   └───────┬────────┘                    
                                           │                             
  ┌────────────────┐               ┌───────┴────────┐                    
  │     GRID       │               │   TRANSFORM    │                    
  └──────┬─────────┘               └───────┬────────┘                    
         │                                 │                             
  ┌──────┴─────────┐               ┌───────┴────────┐                    
  │     COLOR      │ black         │     COLOR      │ white              
  └──────┬─────────┘               └───────┬────────┘                    
         │                                 │                             
  ┌──────┴─────────┐               ┌───────┴────────┐                    
  │     NULL       │ grid          │     NULL       │ curve              
  └──────┬─────────┘               └───────┬────────┘                    
         │                                 │                             
         └─────────────────────────────┐   │                             
                                       │   │                             
                                       │   │                             
                                   ┌───┴───┴────────┐                    
                                   │ Attr. Transfer │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │    Attr. VOP   │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │     COLOR      │ white              
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │    MOUNTAIN    │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │   TRANSFORM    │                    
                                   └───────┬────────┘                    
                                           │                             
                                   ┌───────┴────────┐                    
                                   │      NULL      │ OUT_geo_ground     
                                   └────────────────┘                    
</pre>


<div id="A Scene Build to Show One Solaris Workflow-Creating Water"><h2 id="Creating Water" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Creating Water">Creating Water</a></h2></div>

<p>
Back at the top level of the Object ('/obj') context, add another grid:
</p>

<ul>
<li>
Drop a 'Grid':

<ul>
<li>
rename 'geo_water'

</ul>
<li>
Set grid to 100 x 100

<li>
Add a <code>Color</code> node (inside):

<ul>
<li>
set to a blue to differentiate from the ground.

</ul>
<li>
Inside the geo node, add a <code>Null</code>:

<ul>
<li>
rename 'OUT_geo_water'

</ul>
</ul>
<div id="A Scene Build to Show One Solaris Workflow-Create an FX Reference"><h2 id="Create an FX Reference" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create an FX Reference">Create an FX Reference</a></h2></div>

<p>
At the top level of the SOPS ('/obj' context):
</p>
<ul>
<li>
Create an empty geometry node/container.

<li>
Rename to FX_ball_ref

<li>
Add a <code>Sphere</code>:

<ul>
<li>
Primitive Type:

<ul>
<li>
<code>Polygon</code>

</ul>
<li>
Radius:

<ul>
<li>
1

</ul>
<li>
Uniform Scale:

<ul>
<li>
4

</ul>
<li>
Frequency:

<ul>
<li>
10

</ul>
</ul>
<li>
Add a <code>Color</code> (green?)

<li>
Add a <code>Transform</code>

<ul>
<li>
with 4.3 on the <code>Y</code>

</ul>
</ul>
<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera"><h2 id="Create the Orbiting Camera" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera">Create the Orbiting Camera</a></h2></div>

<ul>
<li>
Create a <code>Null</code>:

<ul>
<li>
Rename to <code>orbit</code>

</ul>
<li>
Create a <code>Camera</code>:

<ul>
<li>
<code>Enter</code> key to edit, and move it way out:

<ul>
<li>
25 in <code>Z</code>

</ul>
<li>
<code>W</code> to see wireframe geo

</ul>
<li>
Connect the output of the orbit null to the camera (to make the Camera a child)

<li>
Now the <code>Y</code> rotation of the null will orbit the camera in the scene.

<li>
The <code>Y</code> Transform will raise the camera also.

</ul>
<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adjusting the Camera Settings"><h3 id="Adjusting the Camera Settings" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adjusting the Camera Settings">Adjusting the Camera Settings</a></h3></div>

<ul>
<li>
Select the <code>Camera</code> node

<li>
<code>Resolution</code> to 1920 x 1080

<li>
<code>Focal Length</code> to 22

<li>
Remember that the parent <code>Null</code> controls:

<ul>
<li>
<code>Y</code> translate (elevation)

<li>
<code>Y</code> rotate (orbit of the camera/child)

<li>
<code>Uniform Scale</code> push in/push out of the camera as a child

</ul>
</ul>
<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Create a Target Null"><h3 id="Create a Target Null" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Create a Target Null">Create a Target Null</a></h3></div>

<ul>
<li>
Create <code>Null</code>

<li>
Rename <code>target_cam</code>

<li>
Select <code>Camera</code> node:

<ul>
<li>
Click on the <code>Look At</code> constraint from the <code>Constraints</code> shelf:

<ul>
<li>
Then select the <code>target_null</code>

<li>
In the Viewport press <code>Enter</code> key

<li>
<code>Enter</code> key again to constrain:

<ul>
<li>
The constraint will be inside the camera node

</ul>
</ul>
</ul>
</ul>
<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Arranging the Camera and Scene"><h3 id="Arranging the Camera and Scene" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Arranging the Camera and Scene">Arranging the Camera and Scene</a></h3></div>

<ul>
<li>
Raise the camera rig so the horizon isn't in the center:

<ul>
<li>
<code>Y</code> translate of 2 on the <code>orbit</code> null

</ul>
<li>
Keyframe a push in:

<ul>
<li>
Frame one, <code>&lt;alt&gt; LMB</code> on the <code>Uniform Scale</code> of 1.64 on the <code>orbit</code> null

<li>
Frame 120, <code>&lt;alt&gt; LMB</code> with <code>Uniform Scale</code> at 1.0

</ul>
<li>
Adjust interpolation of animation curve:

<ul>
<li>
<code>&lt;shift&gt; LMB</code> on <code>Uniform Scale</code> field (to open the curve editor):

<ul>
<li>
<span id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Arranging the Camera and Scene-NOTE"></span><strong id="NOTE">NOTE</strong>: You can open a new tab with 'Animation Editor' if desired.

</ul>
<li>
<code>F</code> to frame all keys

<li>
Box select (<code>LMB</code> drag across) keyframes (start and end)

<li>
Click on the 'linear' for straight-line interpolation icon/button (at the top)

</ul>
<li>
Set an orbit animation:

<ul>
<li>
Frame one, <code>&lt;alt&gt; LMB</code> on the <code>orbit</code> null's <code>Y</code> field (-45)

<li>
Frame 120, <code>&lt;alt&gt; LMB</code> on the <code>orbit</code> field (set at -19)

</ul>
<li>
Adjust interpolation to Linear.

</ul>
<p>
In the animation window, you can drag animated parameters form the <code>Channel List</code> on the left into the main pane to edit.
</p>

<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adding Noise Motion to the Camera"><h3 id="Adding Noise Motion to the Camera" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adding Noise Motion to the Camera">Adding Noise Motion to the Camera</a></h3></div>

<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adding Noise Motion to the Camera-Motion"><h4 id="Motion" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adding Noise Motion to the Camera-Motion">Motion</a></h4></div>
<ul>
<li>
Select the <code>target_cam</code> null, and add motion noise to affect the camera (like hand-held motion)

<li>
<code>RMB</code> on <code>Translate</code> parameter:

<ul>
<li>
Motion FX &gt; Noise

<li>
A Parameters window opens:

<ul>
<li>
Increase the <code>Period</code> (maybe 3.00)

<li>
Lower <code>Amplitude</code> (maybe 5.00)

<li>
Lower <code>Roughness</code> (maybe 0.2)

</ul>
</ul>
</ul>
<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adding Noise Motion to the Camera-Twist"><h4 id="Twist" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Adding Noise Motion to the Camera-Twist">Twist</a></h4></div>

<p>
Introduce some tilt or roll on the camera.
</p>

<ul>
<li>
Inside the <code>Camera</code> node:

<ul>
<li>
Go inside the <code>Constraint</code>

<li>
On the <code>Twist</code> parameter, add the noise again:

<ul>
<li>
Same thing for <code>Period</code>, <code>Amplitude</code> and <code>Roughness</code>

</ul>
</ul>
</ul>
<div id="A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Finish Up Camera"><h3 id="Finish Up Camera" class="header"><a href="#A Scene Build to Show One Solaris Workflow-Create the Orbiting Camera-Finish Up Camera">Finish Up Camera</a></h3></div>

<p>
At the SOP level ('/obj') add a <code>Network Box</code> ('backdrop'):
</p>
<ul>
<li>
Icon on the top bar of the <code>Network Editor</code> panel

<li>
Or

<li>
Select nodes to include:

<ul>
<li>
<code>&lt;shift&gt; O</code> (letter 'o') to create box

</ul>
</ul>
<p>
Type in 'Camera' along the top title bar.
</p>

<pre>
  
  +--------+                  +--------+             
  |  GEO   |geo_ground        |  GEO   |geo_tommy    
  +--------+                  +--------+             
                                                     
  +--------+                  +--------+             
  |  GEO   |geo_water         |  GEO   |FX_ball_ref  
  +--------+                  +--------+             
                                                     
                                                     
+---------------------------------------------------+
|   Camera                                          |
+---------------------------------------------------+
| +--------+                  +--------+            |
| |  NULL  |orbit             |  NULL  |target_cam  |
| +---+----+                  +--------+            |
|     |                                             |
|     |                                             |
| +---+----+                                        |
| | CAMERA |camera                                  |
| +--------+                                        |
|                                                   |
+---------------------------------------------------+

</pre>

<div id="Ground &amp; Water Materials"><h1 id="Ground &amp; Water Materials" class="header"><a href="#Ground &amp; Water Materials">Ground &amp; Water Materials</a></h1></div>
<div id="Ground &amp; Water Materials-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=7585s|YouTube - timecode: 02:06:25]]"><h4 id="[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=7585s|YouTube - timecode: 02:06:25]]" class="header"><a href="#Ground &amp; Water Materials-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=7585s|YouTube - timecode: 02:06:25]]"><a href="https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=7585s">YouTube - timecode: 02:06:25</a></a></h4></div>

<p>
Set the Houdini Interface to the <code>Solaris</code> build.
</p>

<div id="Ground &amp; Water Materials-Go To Stage Context"><h3 id="Go To Stage Context" class="header"><a href="#Ground &amp; Water Materials-Go To Stage Context">Go To Stage Context</a></h3></div>
<p>
Jump into LOPs (Solaris/Stage/USD):
</p>
<ul>
<li>
<code>N</code> key in the <code>Network Editor</code> and choose 'LOPs'

</ul>
<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage"><h2 id="Options for Importing from Objects to Stage" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage">Options for Importing from Objects to Stage</a></h2></div>

<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Strategy 1: Scene Import (All)"><h3 id="Strategy 1: Scene Import (All)" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage-Strategy 1: Scene Import (All)">Strategy 1: Scene Import (All)</a></h3></div>

<p>
Import the elements from the Objects context with an import node:
</p>
<ul>
<li>
Drop a <code>Scene Import (All)</code> node

<li>
Add a <code>Stage Manager</code> node

</ul>
<p>
Voxyde (tutor) prefers a different strategy.
</p>

<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Strategy 2: Scene Import separate Elements"><h3 id="Strategy 2: Scene Import separate Elements" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage-Strategy 2: Scene Import separate Elements">Strategy 2: Scene Import separate Elements</a></h3></div>

<p>
Import the elements from the Objects context with an import node for each of the types:
</p>

<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Strategy 2: Scene Import separate Elements-Camera"><h4 id="Camera" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage-Strategy 2: Scene Import separate Elements-Camera">Camera</a></h4></div>
<ul>
<li>


<li>
<code>Scene Import (camera)</code>:

<ul>
<li>
The filter is set to <code>Cameras</code> already

<li>
<code>Objects</code> is set to <code>*</code> but you can click on the node navigation (right of the field):

<ul>
<li>
choose the explicit camera item

</ul>
</ul>
</ul>
<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest"><h3 id="Import the rest" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest">Import the rest</a></h3></div>

<p>
<span id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest-NOTE"></span><strong id="NOTE">NOTE</strong>: A good habit is to check the OUT null in the items to look for any unnecessary attributes that may exist (<code>i</code> option on the Null object)
</p>

<p>
While you are looking at the <code>OUT null</code>, copy it (<code>&lt;cntl&gt; C</code> or <code>&lt;cmd&gt; C</code>) to use the path.
</p>

<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest-Ground"><h4 id="Ground" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest-Ground">Ground</a></h4></div>

<ul>
<li>
Drop a <code>SOP Import</code> node:

<ul>
<li>
Rename to <code>grnd</code> or <code>ground</code>

<li>
<code>SOP Path</code> field paste the ground null (or just populate with the path):

<ul>
<li>
<code>/obj/geo/ground/OUT_geo_ground</code>

</ul>
<li>
<code>Import Path Prefix</code>:

<ul>
<li>
Change from /$OS to <code>/ENV/ground/geo</code>

<li>
This will start to sort the hierarchy

</ul>
</ul>
<li>
Drop a <code>Merge</code> node:

<ul>
<li>
Merge <code>Scene Import (camera)</code> and the <code>SOP Import</code> nodes

</ul>
</ul>
<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest-Water"><h4 id="Water" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest-Water">Water</a></h4></div>

<ul>
<li>
Duplicate the <code>ground</code> (SOP Import)

<ul>
<li>
Change name to <code>water</code>

<li>
<code>SOP Path</code> to:

<ul>
<li>
<code>/obj/geo_water/OUT_geo_water</code>

</ul>
<li>
<code>Import Path Prefix</code> to <code>/ENV/ground/water</code>

</ul>
<li>
Drop a <code>Merge</code> node to combine with the 'Ground' SOP.

</ul>
<div id="Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest-Continue"><h4 id="Continue" class="header"><a href="#Ground &amp; Water Materials-Options for Importing from Objects to Stage-Import the rest-Continue">Continue</a></h4></div>

<ul>
<li>
Drop a <code>Null</code> at the end of the whole chain and rename <code>OUT_scene</code>

</ul>
<p>
Stage Editor View:
</p>
<pre>

+------------------------+                                     
| Scene Import (camera)  |                                     
|  "sceneimportcameras1" |                                     
+----------+-------------+                                     
           |                                                   
           |              +-------------+       +-------------+
           |              | SOP Import  |       |  SOP Import |
           |              |   "ground"  |       |   "water"   |
           |              +------------++       ++------------+
           |                           |         |             
           |                         +-+---------++            
           |                         |   Merge    |            
           |                         |  "merge2"  |            
           |                         +-----+------+            
           |                               |                   
           |   +---------------------------+                   
           |   |                                               
     +-----+---+-+                                             
     |   Merge   |                                             
     |  "merge1" |                                             
     +-----+-----+                                             
           |                                                   
           |                                                   
     +-----+------+                                            
     |    Null    |                                            
     |"OUT_scene" |                                            
     +------------+                                            
</pre>

<p>
The USD <code>Scene Graph</code> should start to appear organized the hierarchy.
</p>

<div id="Ground &amp; Water Materials-Build Materials"><h2 id="Build Materials" class="header"><a href="#Ground &amp; Water Materials-Build Materials">Build Materials</a></h2></div>

<div id="Ground &amp; Water Materials-Build Materials-Ground"><h3 id="Ground" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Ground">Ground</a></h3></div>

<ul>
<li>
Drop a <code>Material Library</code> node after the geo_ground ('SOP Import') node.

<li>
Inside, <code>Karma Material Builder</code>:

<ul>
<li>
Rename to <code>mtl_ground</code>

<li>
Inside:

<ul>
<li>
Select the <code>mtlxstandard</code> node and change the color

</ul>
</ul>
<li>
Return (up two levels):

<ul>
<li>
<code>Material Path Prefix</code> to <code>/ENV/ground/materials/</code>

<li>
Click on <code>Auto-fill Materials</code> button:

<ul>
<li>
This will bring the <code>geo_ground</code> into Material VOP

<li>
Clear the <code>Material Path</code> so that we use the 'Material Path Prefix' only

</ul>
<li>
Check 'on' the <code>Assign to Geometry</code> checkbox

<li>
<code>Geometry Path</code>, set to <code>/ENV/ground/geo</code> (you can drag this from the Scene Graph panel)

</ul>
</ul>
<div id="Ground &amp; Water Materials-Build Materials-Water"><h3 id="Water" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Water">Water</a></h3></div>

<ul>
<li>
Duplicate the previous <code>Material Library</code> node and place it after the 'water' ('SOP Import') node.

<li>
Inside:

<ul>
<li>
Rename to mtl_water

<li>
Inside:

<ul>
<li>
Change color to blue

</ul>
</ul>
<li>
Return (up two levels):

<ul>
<li>
<code>Material Path Prefix</code> should be good

<li>
Change <code>Material VOP</code> field to <code>geo_water</code>

<li>
Change <code>Geometry Path</code> to <code>/ENV/ground/water</code>

</ul>
</ul>
<div id="Ground &amp; Water Materials-Build Materials-Lighting"><h3 id="Lighting" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Lighting">Lighting</a></h3></div>

<p>
Before the <code>OUT_scene</code> null, add:
</p>
<ul>
<li>
<code>Karma Physical Sky</code> lighting node

<li>
<code>Exposure</code> to 2.0

<li>
<code>Solar Altitude</code> to 18

<li>
<code>Solar Azimuth</code> to 60

</ul>
<p>
In the Viewport:
</p>
<ul>
<li>
<code>&lt;shift&gt; R</code> to start the render

<li>
Switch to XPU or CPU as desired:

<ul>
<li>
This is the drop down where 'Persp' camera drop-down is on the top-right of the Viewport.

</ul>
</ul>
<div id="Ground &amp; Water Materials-Build Materials-Lighting-Save your scene"><h4 id="Save your scene" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Lighting-Save your scene">Save your scene</a></h4></div>

<div id="Ground &amp; Water Materials-Build Materials-Preview Textures (with 'Unlit' shader)"><h3 id="Preview Textures (with 'Unlit' shader)" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Preview Textures (with 'Unlit' shader)">Preview Textures (with 'Unlit' shader)</a></h3></div>
<p>
<span id="Ground &amp; Water Materials-Build Materials-Preview Textures (with 'Unlit' shader)-NOTE"></span><strong id="NOTE">NOTE</strong>: <em>You can use an 'MtlX Surface Unlit' node to preview textures</em> .
</p>
<ul>
<li>
Drop the <code>MtlX Surface Unlit</code> node and plug any out (that you want to preview) into its <code>emission</code> input.

<li>
Connect the 'Surface Unlit' out to the <code>surface</code> input on the <code>Material_Outputs_and_AOVs</code> node.

</ul>
<div id="Ground &amp; Water Materials-Build Materials-Water - Refining Material"><h3 id="Water - Refining Material" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Water - Refining Material">Water - Refining Material</a></h3></div>

<p>
<code>mtlxstandard_surface</code>:
</p>
<ul>
<li>
Color - black

<li>
Specular:

<ul>
<li>
Specular to 1

<li>
Roughness to 0

<li>
Index of Refraction to 1.3

</ul>
<li>
Transmission:

<ul>
<li>
Transmission to 1

<li>
Light gray/blue (0.5, 0.65, 0.85)

<li>
Depth to 2

<li>
Scatter to black

</ul>
</ul>
<div id="Ground &amp; Water Materials-Build Materials-Water - Refining Material-Noise for Normals"><h4 id="Noise for Normals" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Water - Refining Material-Noise for Normals">Noise for Normals</a></h4></div>

<p>
Use the 'Surface Unlit' node (above) to preview.
</p>

<div id="Ground &amp; Water Materials-Build Materials-Water - Refining Material-Noise:"><h4 id="Noise:" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Water - Refining Material-Noise:">Noise:</a></h4></div>

<ul>
<li>
Create an <code>MtlX Position</code> node (setting the 'space'):

<ul>
<li>
Set 'space' to <code>World</code>:

<li>
Now we can scale the noise.

</ul>
<li>
Create an <code>MtlX Multiply</code> node:

<ul>
<li>
Plug 'MtlX Position' node 'out' into the 'MtlX Multiply' 'in1' input.

<li>
Set the component values to 0.3, 1, 1

</ul>
<li>
Create an <code>MtlX Add</code> node:

<ul>
<li>
Plug the out of the 'MtlX Multiply' into the 'in1' input to the 'Add' node.

<li>
Set the Input2 <code>Y</code> component to <code>2.8</code> (later we will add a Time attribute to drive this; see below)

</ul>
<li>
Create an <code>MtlX Fractal3D</code> node for fake waves/ripples:

<ul>
<li>
Plug the 'MtlX Add' 'out into the 'MtlX Fractal3D' 'position' input.

</ul>
<li>
Create an <code>MtlX Remap</code> node:

<ul>
<li>
Plug the 'MtlX Fractal3D' out into the 'MtlX Remap' 'in' input.

<li>
Plug the 'MtlX Remap' 'out' into the 'MtlX Surface Unlit' 'emission' input.

<li>
Set the 'MtlX Remap' Inlow to <code>-1</code> and the Inhigh to <code>1</code>

</ul>
</ul>
<div id="Ground &amp; Water Materials-Build Materials-Water - Refining Material-Adding a Time aspect:"><h4 id="Adding a Time aspect:" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Water - Refining Material-Adding a Time aspect:">Adding a Time aspect:</a></h4></div>

<ul>
<li>
Create an <code>MtlX Time</code> node.

<ul>
<li>
The animation is too fast with just the Time input (frames), so we will attenuate it with a 'divide':

</ul>
<li>
Create an <code>MtlX Divide</code> node:

<ul>
<li>
Set 'Input2' to 2

<li>
Plug the 'out' of the 'MtlX Time' node inot the 'MtlX Divide' 'in1' input

</ul>
<li>
Create an <code>MtlX Combine3</code> node:

<ul>
<li>
Plug the 'out' of the 'MtlX Divide' node into the 'MtlX Combine3' 'in2' input

<li>
Plug the 'out' of the 'MtlX Combine3' into the 'MtlX Add' node's 'in2' input.

</ul>
</ul>
<div id="Ground &amp; Water Materials-Build Materials-Water - Refining Material-Connect to Regular Shader:"><h4 id="Connect to Regular Shader:" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Water - Refining Material-Connect to Regular Shader:">Connect to Regular Shader:</a></h4></div>

<ul>
<li>
Disconnect the 'MtlX Surface Unlit'.

<li>
Plug the regular 'MtlX Standard Surface' 'out' back to the <code>Material_Outputs_and_AOVs</code> 'surface' input.

</ul>
<div id="Ground &amp; Water Materials-Build Materials-Water - Refining Material-Convert the noise network to a Normal Map"><h4 id="Convert the noise network to a Normal Map" class="header"><a href="#Ground &amp; Water Materials-Build Materials-Water - Refining Material-Convert the noise network to a Normal Map">Convert the noise network to a Normal Map</a></h4></div>


<ul>
<li>
Create a <code>MtlX Height to Normal</code> node:

<ul>
<li>
Plug the 'out' of the 'MtlX Remap' into the 'MtlX Height to Normal' 'in' input.

<li>
Set the <code>Scale</code> to something like <code>0.03</code>

</ul>
<li>
Create an <code>MtlX Normal Map</code> node:

<ul>
<li>
Plug the out of the 'MtlX Height to Normal' into the 'in' of the 'MtlX Normal Map'

<li>
Plug the out of the 'MtlX Normal Map' into the <code>Geometry&gt;Normal</code> input of the 'MtlX Standard Shader'

</ul>
</ul>
<div id="Ground &amp; Water Materials-Flipbook"><h2 id="Flipbook" class="header"><a href="#Ground &amp; Water Materials-Flipbook">Flipbook</a></h2></div>

<p>
To create a <code>Flipbook</code> of the animation:
</p>
<ul>
<li>
Set Viewport to Karma (CPU or XPU):

<ul>
<li>
I found CPU quicker, but took longer to look nicer

<li>
XPU took longer overall, but it was smoother in less time.

</ul>
<li>
<code>RMB</code> click the 'Flipbook' icon at the base of the left panel of icons on the Viewport.

<li>
'Flipbook with new settings...'

<li>
Go to the 'Flipbook' Tab, and check 'on' the <code>Limit Frame Time</code> settings:

<ul>
<li>
The tutorial uses a short time of 0.2 (seconds) to get quick feedback on the noise timing.

<li>
I had to use at least 0.6 to get a full frame with any data.

</ul>
<li>
The <code>Size</code> Tab lets you make the 'Flipbook' smaller to speedup further.

<ul>
<li>
50% is a good target to get the feedback required. 

</ul>
</ul>
<div id="Ground &amp; Water Materials-Flipbook-Ground - Refining Material"><h3 id="Ground - Refining Material" class="header"><a href="#Ground &amp; Water Materials-Flipbook-Ground - Refining Material">Ground - Refining Material</a></h3></div>

<p>
Jump into the <code>Material Library</code> node below the ground setup. Jump to the <code>MtlX Standard Surface</code> shader.
</p>
<ul>
<li>
Specular:

<ul>
<li>
Set <code>Roughness</code> to 0.85

</ul>
</ul>
<div id="Ground &amp; Water Materials-Flipbook-Ground - Refining Material-Noise"><h4 id="Noise" class="header"><a href="#Ground &amp; Water Materials-Flipbook-Ground - Refining Material-Noise">Noise</a></h4></div>

<ul>
<li>
Create an <code>MtlX Position</code>

<li>
Create an <code>MtlX Multiply</code>:

<ul>
<li>
Plug position 'out' to 'in1' on multiply node

<li>
Set the <code>Signature</code> to <code>Vector 3 (FA)</code>

<li>
Set <code>Input2</code> value to 0.25

</ul>
<li>
Create an <code>MtlX Fractal3D</code> node:

<ul>
<li>
Plug multiply 'out' to fractal's 'position' input

<li>
Set <code>Signature</code> to <code>Float</code>

<li>
Set <code>Octaves</code> to 10

<li>
Set <code>Diminish</code> to 0.94

</ul>
<li>
Create an <code>MtlX Remap</code> node:

<ul>
<li>
Plug the fractal 'out' to the remap's 'in' input

</ul>
<li>
Create an <code>Karma Ramp Const</code> node:

<ul>
<li>
On the ramp:

<ul>
<li>
Set first (left) color to: 0.15, 0.1, 0.05 

<li>
Set second (right) color to: 0.48, 0.43, 0.33

<li>
Add intermediate colors to taste (by dropping new ramp nodes along the spectrum)

</ul>
</ul>
</ul>
<div id="Ground &amp; Water Materials-Flipbook-Ground - Displacement"><h3 id="Ground - Displacement" class="header"><a href="#Ground &amp; Water Materials-Flipbook-Ground - Displacement">Ground - Displacement</a></h3></div>

<p>
Continue to build on the Ground material network to add Displacement:
</p>
<ul>
<li>
Copy all the nodes from the <code>MtlX Position</code> node thru to the <code>MtlX Fractal3D</code> node. (3 nodes) 

<li>
Paste these down:

<ul>
<li>
Plug the fractal 'out' into the existing <code>MtlX Displacement</code> 'displacement' input.

</ul>
<li>
On the 'MtlX Displacement' node:

<ul>
<li>
Adjust the <code>Scale</code> to 0.1

</ul>
<li>
On the 'MtlX Fractal3D' node:

<ul>
<li>
Adjust the <code>Diminish</code> to around 0.65

</ul>
</ul>
<div id="Ground &amp; Water Materials-Flipbook-Grass &amp; Hair Material"><h3 id="Grass &amp; Hair Material" class="header"><a href="#Ground &amp; Water Materials-Flipbook-Grass &amp; Hair Material">Grass &amp; Hair Material</a></h3></div>
<div id="Ground &amp; Water Materials-Flipbook-Grass &amp; Hair Material-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=8791s|YouTube - timecode: 02:26:31]]"><h4 id="[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=8791s|YouTube - timecode: 02:26:31]]" class="header"><a href="#Ground &amp; Water Materials-Flipbook-Grass &amp; Hair Material-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=8791s|YouTube - timecode: 02:26:31]]"><a href="https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=8791s">YouTube - timecode: 02:26:31</a></a></h4></div>

<p>
To create the Grass - the tutorial stays in the Solaris/Stage/USD context. 
</p>

<div id="Ground &amp; Water Materials-Flipbook-Single Blade of Grass"><h3 id="Single Blade of Grass" class="header"><a href="#Ground &amp; Water Materials-Flipbook-Single Blade of Grass">Single Blade of Grass</a></h3></div>
<ul>
<li>
Create a <code>SOP Create</code> node:

<ul>
<li>
Rename node to <code>grass</code>

<li>
<code>Import Path Prefix</code> set to <code>/ENV/ground/grass</code>

</ul>
<li>
Plug into the <code>Merge</code> that combines the water &amp; ground 

<li>
Inside the 'SOP Create' node:

<ul>
<li>
Create one blade grass:

<ul>
<li>
Drop a <code>Line</code> node:

<ul>
<li>
<code>Length</code> to 0.2

</ul>
<li>
Add a <code>Resample</code> node:

<ul>
<li>
<code>Length</code> to 0.06

<li>
Check 'on' the <code>Curve U Attribute</code>

</ul>
<li>
Add a <code>Bend</code> node:

<ul>
<li>
Set <code>Capture Direction</code> to 0, 1, 0

<li>
Copy the <code>Length</code> from the <code>Line</code> node (<code>RMB &gt; Copy Paramter</code>)

<li>
<code>RMB &gt; Paste Relative References</code> on the <code>Capture Length</code> on the 'Bend' parameters.

<li>
Press <code>Enter</code> in the viewport to get the manipulator:

<ul>
<li>
Bend to about 55º or 65º

</ul>
</ul>
<li>
<span id="Ground &amp; Water Materials-Flipbook-Single Blade of Grass-NOTE"></span><strong id="NOTE">NOTE</strong>: in the tutorial, the viewport 'show materials' had to be turned OFF due to the ground disappearing.

<li>
Add an <code>Attribute VOP</code>:

<ul>
<li>
Rename to <code>set_pscale</code>

<li>
Inside:

<ul>
<li>
Drop a <code>bind</code> node

<li>
'Name' field to <code>curveu</code>

<li>
Connect a <code>Ramp Parameter</code>:

<ul>
<li>
set <code>Ramp Type</code> to <code>Spline Ramp (float)</code>

</ul>
<li>
Add a <code>Multiply</code> (to input1):

<ul>
<li>
Promote input2 value

<li>
Click on input 2:

<ul>
<li>
Set <code>Label</code> to <code>Pscale global</code>

</ul>
</ul>
<li>
Add <code>Bind Export</code> node:

<ul>
<li>
'Name' to <code>pscale</code>

</ul>
</ul>
</ul>
<li>
Go up out of the Attr Vop

<li>
Click on the 'ramp' parameter to reset

<li>
Reverse the ramp (there is a button for that on the top right of the ramp spline display)

<li>
Add a point perhaps to make the grass more parallel until an end sharpness.

<li>
Set our <code>Pscale global</code> value to 0.01

<li>
Add an <code>Output</code> node

</ul>
</ul>
<li>
To see the effect, go to the upper Solaris/Stage/USD level and 'Pin' the viewport. You can now jump back into the Attribute VOP ('set_pscale') to tweak and see the results.

<li>
The HOUDINI GL display will show it as a 2d representation.

<li>
The Karma CPU &amp; XPU options will show it as a tube.

</ul>
<div id="Ground &amp; Water Materials-Flipbook-Scatter"><h3 id="Scatter" class="header"><a href="#Ground &amp; Water Materials-Flipbook-Scatter">Scatter</a></h3></div>

<ul>
<li>
Go back to the Object context (<code>N</code> key in the 'Network Editor' and choose <code>Objects</code>):

<ul>
<li>
Go into the <code>geo_ground</code> SOP and select and copy the OUT_geo_ground node

</ul>
<li>
Jump back to the Solaris/Stage/USD (<code>LOPs</code> context):

<ul>
<li>
Go into the <code>grass</code> node (the 'SOP Create'):

<ul>
<li>
Drop a free-floating <code>Object Merge</code> node

<li>
Paste the path from the OUT_geo_ground into the <code>Object1</code> field.

</ul>
</ul>
</ul>
<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool"><h2 id="Voxyde custom Frustum Tool" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool">Voxyde custom Frustum Tool</a></h2></div>

<p>
To get the custom HDA/OTL from Voxyde's site, you need to sign up for the free course page for this Tutorial series:
</p>
<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-[[https://voxyde.com/intro-to-houdini-solaris/|Voxyde - Course Sign-up (Free)]]"><h4 id="[[https://voxyde.com/intro-to-houdini-solaris/|Voxyde - Course Sign-up (Free)]]" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-[[https://voxyde.com/intro-to-houdini-solaris/|Voxyde - Course Sign-up (Free)]]"><a href="https://voxyde.com/intro-to-houdini-solaris/">Voxyde - Course Sign-up (Free)</a></a></h4></div>

<p>
The <code>Frustum_Camera</code> tool lays down a custom representation of the camera path and a series of frustum views (as square cones) to indicate the field of view through the animation.
</p>

<p>
Back to the tutorial.
</p>

<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-Scatter (continued)"><h3 id="Scatter (continued)" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-Scatter (continued)">Scatter (continued)</a></h3></div>


<p>
To Limit the Amount of scattered grass, we can cull the ground to the camera view:
If you get hold of the <code>Frustum_Camera</code> HDA from the site above:
</p>
<ul>
<li>
Drop a 'Frustum_Camera' node (free floating)

<li>
In the parameters:

<ul>
<li>
<code>Cam</code> field - enter the scene camera <code>/obj/cam1</code> (Or whatever 'your' cam is called.)

<li>
In the tutorial, scale <code>X</code> &amp; <code>Y</code> to 1.2, the <code>Z</code> to 60 (and adjust later when you see what it's doing!)

</ul>
<li>
Create a <code>Group</code> node:

<ul>
<li>
Plug the <code>Object Merge</code> into the left input

<li>
Plug the <code>Frustum_Camera</code> into the right

<li>
Set the <code>Group Type</code> to 'Points'

<li>
Un-check the <code>Base Group</code> 'Enable' checkbox

<li>
Check the <code>Keep in Bounding Regions</code>, 'Enable':

<ul>
<li>
<code>Bounding Type</code> to 'Bounding Object (points of vertices only)

</ul>
</ul>
<li>
This is a good time to look at the effect and adjust the <code>Z</code> scale of the 'Frustum_Camera'

<li>
Add a <code>Blast</code> node:

<ul>
<li>
Set to <code>Delete Non Selected</code> to remove geo from outside the frustum of the camera.

</ul>
<li>
Add an <code>Attribute VOP</code> node:

<ul>
<li>
Name as 'set_density'

<li>
Inside:

<ul>
<li>
Add <code>Turbulent Noise</code> node

<li>
<code>P</code> to <code>pos</code>

<li>
<code>noise</code> to <code>Cd</code>

<li>
<code>Noise Type</code> - Alligator Noise

<li>
<code>Frequency</code> to 0.4

<li>
<code>Roughness</code> to 0.6

<li>
<code>Attenuation</code> to 1.4

<li>
Add a <code>Bind Export</code> node:

<ul>
<li>
<code>Name</code> parameter to 'density'

</ul>
<li>
Break the connection to the <code>Cd</code> (that was just for preview)

</ul>
</ul>
<li>
Add a <code>Scatter</code> node:

<ul>
<li>
Set <code>Density Attribute</code> to 'density'

<li>
Disable <code>Relax Iterations</code>

<li>
Set <code>Force Total Count</code> to 500,000

<li>
Disable <code>Max Point Limit</code>

</ul>
<li>
Remove scatter below the water line:

<ul>
<li>
Drop a <code>Clip</code> node

<li>
Set <code>Direction</code> to 0, 1, 0

<li>
Adjust the <code>Distance</code> till the water line is matched (although 'zero' should be about right).

</ul>
</ul>
<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-Connecting to the Existing Network"><h3 id="Connecting to the Existing Network" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-Connecting to the Existing Network">Connecting to the Existing Network</a></h3></div>


<ul>
<li>
Cut the <code>Output</code> node from the end of the network (<code>Y</code>)

<li>
Add a <code>Copy to Points</code> node and:

<ul>
<li>
Put the output of <code>set_pscale</code> into the left input

<li>
Put the output of <code>scatter</code> into the right input

</ul>
</ul>
<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-Normals"><h3 id="Normals" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-Normals">Normals</a></h3></div>

<p>
After the <code>set_density</code> ('Attribute VOP') node:
</p>
<ul>
<li>
Add a <code>Normal</code> node:

<ul>
<li>
Set <code>Add Normals to</code> to 'Points'

</ul>
</ul>
<p>
After the <code>Scatter</code> node:
</p>
<ul>
<li>
Add a <code>Scatter and Align</code> node:

<ul>
<li>
Set <code>Mode</code> to 'Add Attributes to Existing Point Cloud'

<li>
Connect the 'Scatter' output to the input on the right.

<li>
<code>Min Radius</code> to  0.5

<li>
<code>Max Radius</code> to 1.97

<li>
<code>Uniform Scale</code> to 1.2

<li>
In the <code>Orientation</code> tab:

<ul>
<li>
<code>Rotation</code>:

<ul>
<li>
<code>Max Random Cone Angle</code> to 28

</ul>
<li>
<code>Rotation Around Normal</code>:

<ul>
<li>
<code>Max Angle</code> to 360

</ul>
</ul>
<li>
The output of the 'Scatter and Align' should go into the 'Copy to Points' node

</ul>
</ul>
<p>
Connect the end of the network ('copy to points' node) to the <code>Output</code> node.
</p>

<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-Pipe Grass to Solaris"><h3 id="Pipe Grass to Solaris" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-Pipe Grass to Solaris">Pipe Grass to Solaris</a></h3></div>

<p>
Jump back to Solaris/Stage/USD and take a look at the <code>grass</code> ('SOP Create') node. 
</p>

<p>
Looking in the <code>Scene Graph</code> (Geometry Spreadsheet), you can see that the whole grass comes in as a single 'curve' unit.
</p>

<p>
In the tutorial video, the Viewport bugs-out, and some geo disappears and the materials don't show up correctly. To fix, the 'show materials' icon on the right panel of the Viewport was toggled (as was Karma/Houdini GL).
</p>

<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-Creating Materials for the Grass"><h3 id="Creating Materials for the Grass" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-Creating Materials for the Grass">Creating Materials for the Grass</a></h3></div>

<p>
In the Solaris/Stage/USD context:
</p>
<ul>
<li>
Add a <code>Material Library</code> node:

<ul>
<li>
Inside, create a <code>Karma Material Builder</code>:

<ul>
<li>
Rename to 'grass'

<li>
Inside:

<ul>
<li>
Delete all three nodes:

<ul>
<li>
<code>mtlxstandard_surface</code>

<li>
<code>mtlxdisplacement</code>

<li>
<code>material_properties</code>

</ul>
<li>
Drop a <code>Karma Hair</code> shader.

<li>
Plug <code>surface</code> into <code>next</code> in <code>Material_Outputs_and_AOVs</code> (and it'll change to <code>surface</code> once attached)

</ul>
<li>
Up a level:

<ul>
<li>
Click <code>Auto-fill Materials</code>

<li>
<code>Material Path Prefix</code> to <code>/Env/ground/materials</code>

<li>
Delete the field contents of <code>Material Path</code>

<li>
Check <code>Assign to Geometry</code>

<li>
Drag 'grass' from the Geometry Spreadsheet ('Scene Graph') to the <code>Geometry Path</code>

</ul>
<li>
Inside - Edit the <code>Karma Hair</code>:

<ul>
<li>
On the <code>Color</code> tab:

<ul>
<li>
<code>Base Color</code> to 0.5, 1, 0

<li>
<code>Melanin</code> to 0.136

<li>
<code>Melanin Redness</code> to 0.057

</ul>
<li>
<code>Diffuse</code> tab:

<ul>
<li>
<code>Diffuse</code> slider to 0.67 

<li>
<code>Diffuse Color</code> to a green

</ul>
<li>
<code>Specular</code> tab:

<ul>
<li>
<code>Roughness</code> to 0.7

</ul>
</ul>
</ul>
</ul>
</ul>
<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-Randomizing color of Grass Strands"><h3 id="Randomizing color of Grass Strands" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-Randomizing color of Grass Strands">Randomizing color of Grass Strands</a></h3></div>

<p>
Jump up to the <code>grass</code> ('SOP Create').
</p>
<ul>
<li>
Inside:

<ul>
<li>
Between the 'scatteralign' and the 'copytopoints':

<ul>
<li>
Add <code>Attribute Wrangle</code>:

<ul>
<li>
<code>VEXpression</code>:

<ul>
<li>
@id = @ptnum;

</ul>
</ul>
<li>
To turn on the 'visualizer' for this new attribute:

<ul>
<li>
<code>i</code> on the <code>copy to points</code> node (info):

<li>
Switch on the little switch on the <code>id</code> attribute list

<li>
In the viewport, you should see the colors across the grass in Houdini GL mode:

<ul>
<li>
If not, <code>RMB</code> on the icon and set the checkbox to 'on' for the id

</ul>
<li>
Turn on/off the visualizer on the icon on the right panel of the Viewport (looks like a location icon)

</ul>
</ul>
</ul>
</ul>
<p>
Back inside the <code>Material Library</code> &gt; <code>grass</code> ('Material Builder'):
</p>
<ul>
<li>
Add a <code>USD Prim Var Reader</code> node:

<ul>
<li>
<code>Signature</code> to 'Int'

<li>
<code>Var Name</code> to id

</ul>
<li>
Add to this an <code>MtlX Random Float</code> node:

<ul>
<li>
connect the 'USD Prim Var Reader' output to the <code>seed</code> input.

<li>
Connect the <code>out</code> to the <code>Karma Hair</code> to both:

<ul>
<li>
'baseColor' input.

<li>
'diffuseColor' input.

</ul>
</ul>
<li>
Now between the 'MtlX Random Float' and the 'Karma Hair':

<ul>
<li>
Add a <code>Karma Ramp Constant</code> node.

<li>
Set colors along the ramp (and the random float will designate the color forwarded)

</ul>
</ul>
<div id="Ground &amp; Water Materials-Voxyde custom Frustum Tool-Visualize node"><h3 id="Visualize node" class="header"><a href="#Ground &amp; Water Materials-Voxyde custom Frustum Tool-Visualize node">Visualize node</a></h3></div>

<p>
The <code>Visualize</code> node can be dropped anywhere along the shader node chain to visualize the appearance of the data in the Viewport Render. However, this only works if the network is actually passing through a 'shader'. (I don't think it works like the unlit shader option.)
</p>
<ul>
<li>
Select a node, then the <code>x</code> key to drop a <code>Visualizer</code> node

</ul>
<div id="Ground &amp; Water Materials-Trees"><h2 id="Trees" class="header"><a href="#Ground &amp; Water Materials-Trees">Trees</a></h2></div>
<div id="Ground &amp; Water Materials-Trees-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=9959s|YouTube - timecode: 02:45:59]]"><h4 id="[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=9959s|YouTube - timecode: 02:45:59]]" class="header"><a href="#Ground &amp; Water Materials-Trees-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=9959s|YouTube - timecode: 02:45:59]]"><a href="https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=9959s">YouTube - timecode: 02:45:59</a></a></h4></div>
<div id="[[houdini_voxyde_intro_to_solaris_parttwo_trees|Jump to Trees - Click here]]"><h1 id="[[houdini_voxyde_intro_to_solaris_parttwo_trees|Jump to Trees - Click here]]" class="header"><a href="#[[houdini_voxyde_intro_to_solaris_parttwo_trees|Jump to Trees - Click here]]"><a href="houdini_voxyde_intro_to_solaris_parttwo_trees.html">Jump to Trees - Click here</a></a></h1></div>

<p>
After setting up the Trees, we are back to the scene.
</p>

<div id="[[houdini_voxyde_intro_to_solaris_parttwo_trees|Jump to Trees - Click here]]-Karma Fog Box"><h2 id="Karma Fog Box" class="header"><a href="#[[houdini_voxyde_intro_to_solaris_parttwo_trees|Jump to Trees - Click here]]-Karma Fog Box">Karma Fog Box</a></h2></div>
<div id="[[houdini_voxyde_intro_to_solaris_parttwo_trees|Jump to Trees - Click here]]-Karma Fog Box-[[https://youtu.be/3BX97YIQERE?si=yN3cY_gXMtlG6qpV&amp;t=13653|YouTube - timecode: 03:47:32]]"><h4 id="[[https://youtu.be/3BX97YIQERE?si=yN3cY_gXMtlG6qpV&amp;t=13653|YouTube - timecode: 03:47:32]]" class="header"><a href="#[[houdini_voxyde_intro_to_solaris_parttwo_trees|Jump to Trees - Click here]]-Karma Fog Box-[[https://youtu.be/3BX97YIQERE?si=yN3cY_gXMtlG6qpV&amp;t=13653|YouTube - timecode: 03:47:32]]"><a href="https://youtu.be/3BX97YIQERE?si=yN3cY_gXMtlG6qpV&amp;t=13653">YouTube - timecode: 03:47:32</a></a></h4></div>

<p>
At the <code>Stage</code> level, after the <code>Karma Physical Sky</code> node (before the <code>OUT_scene</code> null):
</p>
<ul>
<li>
Add a <code>Karma Fog Box</code>:

<ul>
<li>
<code>Uniform Scale</code> big enough to encompass the scene, maybe 100

<li>
<code>Density</code> to 0.01

<li>
<code>Shadow Density</code> to 0.05

<li>
<code>Scattering Phase</code> to 0.5

<li>
From a viewpoint outside of the geo, adjust the box using the handles.

</ul>
</ul>
<p>
<code>Karma Physical Sky</code> tweaks:
</p>
<ul>
<li>
Play around with the Sky/Sun arrangement to get a good 'look'.

<li>
Maybe boost the exposure to 3.

<li>
You can change the exposure of the sun only, by going to:

<ul>
<li>
<code>Sun</code> tab:

<ul>
<li>
<code>Base</code> and the <code>Exposure</code> (maybe 1)

</ul>
</ul>
<li>
Soften the rays by increasing the Sun's <code>Angular Size</code>

</ul>
<div id="Particles in Solaris"><h1 id="Particles in Solaris" class="header"><a href="#Particles in Solaris">Particles in Solaris</a></h1></div>
<div id="Particles in Solaris-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=14355s|YouTube - timecode 03:59:15]]"><h4 id="[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=14355s|YouTube - timecode 03:59:15]]" class="header"><a href="#Particles in Solaris-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=14355s|YouTube - timecode 03:59:15]]"><a href="https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=14355s">YouTube - timecode 03:59:15</a></a></h4></div>

<p>
While this isn't the ONLY way to deal with building particles for the scene, we will:
</p>
<ul>
<li>
Build in the <code>Object</code> context

<li>
Import into LOPs/Stage to use in Solaris

</ul>
<div id="Particles in Solaris-Bring the Hero Trees from LOPs to the Objects Context for Reference"><h3 id="Bring the Hero Trees from LOPs to the Objects Context for Reference" class="header"><a href="#Particles in Solaris-Bring the Hero Trees from LOPs to the Objects Context for Reference">Bring the Hero Trees from LOPs to the Objects Context for Reference</a></h3></div>

<p>
From the <code>Scene Graph Path</code> panel in the <code>Geometry Spreadsheet</code>, select and copy (the path) of the 'hero_trees' (with <code>&lt;cntl&gt; C</code>). You'll have to be looking near or at the end of the scene network to get the whole hierarchy.
</p>

<p>
Jump to the Object Context (<code>N</code> in the <code>Network Editor</code> and choose <code>Objects</code>)
</p>
<ul>
<li>
Create a <code>Geometry</code> container

<li>
Name as <code>trees_ref</code>

<li>
Inside, create a <code>LOP Import</code> node:

<ul>
<li>
<code>LOP Path</code> set to <code>/stage</code> (and this would be further down if things were nested in other LOP Networks)

<li>
<code>Primitives</code> set to <code>/Env/trees/hero_trees</code> (you can paste this if you copied the path as in the last step)

<li>
<code>Purpose</code> gives the choice of 'proxy', 'render' or 'simproxy' for example:

<ul>
<li>
The default is 'proxy'.

<li>
You can list more than one.

<li>
The tutorial used 'render' only.

</ul>
<li>
Looking at the <code>i</code> information on the LOP Import node, you'll see that it comes in as a packed prim:

<ul>
<li>
If you wanted to do any operations on the contents, you'd have to unpack the USD prim:

<ul>
<li>
<code>Unpack USD</code> to unpack

<li>
<code>Unpack USD to Polygons</code> to unpack (but with settings already placed to use polygons)

</ul>
<li>
We don't need to unpack these for this tutorial.

</ul>
</ul>
</ul>
<div id="Particles in Solaris-Particles Setup"><h2 id="Particles Setup" class="header"><a href="#Particles in Solaris-Particles Setup">Particles Setup</a></h2></div>

<div id="Particles in Solaris-Particles Setup-Setup the initial randomly spinning points"><h3 id="Setup the initial randomly spinning points" class="header"><a href="#Particles in Solaris-Particles Setup-Setup the initial randomly spinning points">Setup the initial randomly spinning points</a></h3></div>

<p>
In the <code>Objects Context</code>:
</p>
<ul>
<li>
Create an empty <code>Geometry</code> container:

<ul>
<li>
Name it <code>FX_particles</code>

</ul>
<li>
Inside:

<ul>
<li>
Drop a <code>Sphere</code>:

<ul>
<li>
<code>Primitive Type</code> to <code>Polygon Mesh</code>

<li>
<code>Uniform Scale</code> to 2

</ul>
<li>
Drop a <code>Scatter</code> node:

<ul>
<li>
Check on <code>Force Total Count</code> and give a value of 6

<li>
<code>Global Seed</code> to 14

<li>
Disable <code>Relax Iterations</code>

</ul>
<li>
Add an <code>Attribute VOP</code> to rotate the points over the sphere:

<ul>
<li>
Rename to <code>rotate_pts</code>:

<ul>
<li>
Step inside:

<ul>
<li>
Join 'P' to 'P'

<li>
One method is to use a <code>Transform Matrix</code> node between the 'p' and 'p' (and set rotation values):

<ul>
<li>
But we'll try something else

</ul>
<li>
onwards...

<li>
Add a <code>Multiply</code> node between the 'P' out and 'P' in:

<li>
Next method is using a <code>Rotate</code> function node (plugged into to 'input 2' of the 'Multiply'):

<ul>
<li>
<code>Axis</code> determines the axis of rotation given as a vector triplet:

<ul>
<li>
The tutorial used a 'straight up' vector, so <code>0, 1, 0</code>

</ul>
<li>
<code>Angle</code> is the rotation about the given 'Axis'

</ul>
<li>
From the 'ptnum' output on the start node:

<ul>
<li>
Add a <code>Gaussian Random</code> node (and plug the input to the <code>seed</code> input).

</ul>
<li>
Normalize the output with a <code>Normalize</code> node:

<ul>
<li>
Plug the <code>nrand</code> output from the <code>Gaussian Random</code> to the <code>vec</code> input.

</ul>
<li>
Plug the <code>nvec</code> output into the <code>axis</code> input on the <code>Rotate</code> node.

</ul>
<li>
Now as the <code>Angle</code> is changed on the <code>Rotate</code> node, the particles spin on random axis

<li>
Plug the <code>Time</code> output on the first node to the <code>angle</code> input on the <code>Rotate</code> node:

<ul>
<li>
We could add a <code>Multiply</code> along this chain if we wanted to alter the speed.

<li>
If you use a <code>Multiply</code> make sure the multiply amount is not zero.

</ul>
</ul>
</ul>
</ul>
</ul>
<div id="Particles in Solaris-Particles Setup-Create the 'emitting' geometry to connect to these Points"><h3 id="Create the 'emitting' geometry to connect to these Points" class="header"><a href="#Particles in Solaris-Particles Setup-Create the 'emitting' geometry to connect to these Points">Create the 'emitting' geometry to connect to these Points</a></h3></div>

<p>
After the <code>rotate_pts</code> ('Attribute VOP') node:
</p>
<ul>
<li>
Add a <code>Copy to Points</code> node:

<ul>
<li>
Add a <code>Sphere</code> and plug into the first (left) input of the <code>Copy to Points</code> node:

<ul>
<li>
<code>Primitive Type</code> to 'Polygon Mesh'

<li>
<code>Uniform Scale</code> to 0.20

</ul>
<li>
Plug the <code>rotate_pts</code> node into the second (right) input of the <code>Copy to Points</code> node

</ul>
</ul>
<div id="Particles in Solaris-Particles Setup-Setup the Particle Emission"><h3 id="Setup the Particle Emission" class="header"><a href="#Particles in Solaris-Particles Setup-Setup the Particle Emission">Setup the Particle Emission</a></h3></div>

<p>
After the <code>Copy to Points</code>:
</p>
<ul>
<li>
Add a <code>POP Network</code>, and inside:

<ul>
<li>
<code>POP Source</code> ('source_first_input'):

<li>
<code>Birth</code> Tab:

<ul>
<li>
<code>Const. Birth Rate</code> to 500,000 (but don't type the comma!)

<li>
<code>Life Expectancy</code> to 2 (seconds)

</ul>
<li>
Add a wind force - <code>POP Wind</code> node:

<ul>
<li>
<code>Amplitude</code> to 1.2

<li>
<code>Swirl Size</code> to 1.8

</ul>
<li>
To preview, you might want to switch from 'points' to 'pixels':

<ul>
<li>
On the 'Texture' icon (checker cube) on the right panel of the viewport:

<ul>
<li>
<code>RMB</code> and chose <code>pixels</code> for the 'Particles'

</ul>
</ul>
</ul>
</ul>
<div id="Particles in Solaris-Particles Setup-Setup the Particle Emission-To creating velocity on the particles"><h4 id="To creating velocity on the particles" class="header"><a href="#Particles in Solaris-Particles Setup-Setup the Particle Emission-To creating velocity on the particles">To creating velocity on the particles</a></h4></div>

<p>
After the <code>rotate_pts</code> ('Attribute VOP'):
</p>
<ul>
<li>
Add a <code>Trail</code> node:

<ul>
<li>
<code>Result Type</code> to <code>Compute Velocity</code>

<li>
You can activate the 'velocity vector' visibility using the icon on the right-most Viewport panel

<li>
Now the velocity of the points will be passed onto the emitting spheres and on to the particles

</ul>
<li>
After the <code>POP Network</code>:

<ul>
<li>
Add an <code>Attribute VOP</code>:

<ul>
<li>
Name it <code>set_Cd</code>

<li>
Inside:

<ul>
<li>
Create a freestanding <code>Bind</code> node:

<ul>
<li>
The <code>Name</code> parameter to <code>nage</code>

</ul>
<li>
Add a <code>Ramp Parameter</code> node:

<ul>
<li>
plug the ramp output to the <code>Cd</code> on the 'geometryvopoutput' node 

<li>
Remember to jump up a level and click on the 'ramp' label to initialize and edit there:

<ul>
<li>
Color the ramp with three parts (or whatever):

<ul>
<li>
purple, green and dark blue/green

</ul>
</ul>
</ul>
</ul>
</ul>
<li>
Add another <code>Attribute VOP</code>:

<ul>
<li>
Name it <code>set_pscale</code>

<li>
Inside:

<ul>
<li>
Create a freestanding <code>Bind</code> node:

<ul>
<li>
The <code>Name</code> parameter to <code>nage</code>

</ul>
<li>
Add a <code>Ramp Parameter</code> node:

<ul>
<li>
Set the <code>Ramp Type</code> to <code>Spline Ramp (float)</code>

<li>
Now jump up a level and click on the 'ramp' label to initialize

<li>
Back into the set_pscale level...

</ul>
<li>
Add a <code>Bind Export</code> node:

<ul>
<li>
<code>ramp</code> output to <code>input</code> on this node

<li>
<code>Name</code> parameter to <code>pscale</code>

</ul>
<li>
Place a <code>Multiply</code> between these last two nodes (Ramp and Bind):

<ul>
<li>
Promote 'input 2'

<li>
<code>Label</code> to <code>Global pscale</code>

</ul>
</ul>
</ul>
</ul>
<li>
Jump back up to inside the <code>FX_particles</code> level:

<ul>
<li>
Select the <code>set_pscale</code> node:

<ul>
<li>
Reset the <code>ramp</code> by clicking on it.

<li>
Reverse the ramp using the 'reverse' icon (this will reduce the size of particles as they get older):

<ul>
<li>
It should look like a downward hill

</ul>
<li>
Maybe add another point to make it roll off (and convert to <code>B-spline</code> using the interpolation drop-down)

</ul>
<li>
<code>Global pscale</code> slider (our custom one!), set to 0.01:

<ul>
<li>
You can preview this by <code>RMB</code> on the 'Texture' icon on the right-most of the Viewport menu:

<ul>
<li>
Choose <code>Lit Spheres</code> on the <code>Particles</code> section

</ul>
</ul>
</ul>
</ul>
<div id="Particles in Solaris-Particles Setup-Finishing up setup"><h3 id="Finishing up setup" class="header"><a href="#Particles in Solaris-Particles Setup-Finishing up setup">Finishing up setup</a></h3></div>

<p>
After the <code>set_pscale</code> node:
</p>
<ul>
<li>
Add a <code>File Cache</code> node:

<ul>
<li>
<code>Base Name</code> to <code>pop_trails</code>

<li>
<code>Save to Disk</code>

</ul>
<li>
Add a <code>Transform</code> to scale the particles from nothing to present on the animation timeline:

<ul>
<li>
At frame 1, set the <code>Uniform Scale</code> to zero and keyframe (<code>MMB</code>)

<li>
At frame 72, set the scale to 1.6 and set a keyframe

</ul>
<li>
Add a <code>Transform</code> node to lift the particles off the ground:

<ul>
<li>
<code>Translate</code> to about 7 in <code>Y</code>

</ul>
</ul>
<div id="Particles in Solaris-Particles Setup-Randomize Particle colors"><h3 id="Randomize Particle colors" class="header"><a href="#Particles in Solaris-Particles Setup-Randomize Particle colors">Randomize Particle colors</a></h3></div>

<p>
For each of the initial points, we'll need an identifier:
</p>
<ul>
<li>
After the <code>trail</code> node:

<ul>
<li>
Add an <code>Attribute Wrangle</code>:

<ul>
<li>
<code>@class = @ptnum;</code>

</ul>
<li>
Re-cache the particles (<code>filecache</code> node - <code>Save to Disk</code>)

<li>
Using the Viewport visualizer, you should be able to preview the attribute by turning on class

</ul>
</ul>
<p>
Jump back into the <code>set_Cd</code> 'Attribute VOP':
</p>
<ul>
<li>
Add a <code>Color Correct</code> node between the ramp and the output nodes:

<ul>
<li>
Drop a freefloating <code>Bind</code> node:

<ul>
<li>
Set the <code>Name</code> parameter to <code>class</code>

</ul>
<li>
Drop a <code>Random</code> node

<li>
Bind's <code>class</code> output to the random's <code>pos</code> input

<ul>
<li>
From the random node's <code>rand</code> output, add a <code>Fit Range</code> node:

<ul>
<li>
Plug the output (<code>shift</code>) to the color correction's <code>Shift</code> input

<li>
<code>Signature</code> to <code>Float</code>

<li>
<code>Destination Max</code> to 0.6

</ul>
</ul>
</ul>
</ul>
<p>
Back at the <code>FX_particles</code> level:
</p>
<ul>
<li>
Drop a <code>Null</code> and rename to <code>OUT_pops</code>

<li>
Between this end null and the previous transform:

<ul>
<li>
Drop an <code>Attribute Delete</code>:

<ul>
<li>
check 'On' <code>Delete Non Selected</code>:

<ul>
<li>
Keep:

<ul>
<li>
<code>Point Attributes</code> to <code>Cd v pscale</code> (to keep color, velocity and pscale)

</ul>
</ul>
</ul>
</ul>
<li>
Copy the end null (<code>&lt;cntl&gt; C</code>)

</ul>
<div id="Particles in Solaris-Bringing the Particles into Stage"><h2 id="Bringing the Particles into Stage" class="header"><a href="#Particles in Solaris-Bringing the Particles into Stage">Bringing the Particles into Stage</a></h2></div>

<p>
Jump to LOPS:
</p>
<ul>
<li>
<code>N</code> and choose <code>LOPs</code> from the radial menu 

<li>
Add a free-floating <code>SOP Import</code> node (below trees perhaps):

<ul>
<li>
Rename it <code>particle_sim</code>

<li>
If you copied the <code>OUT_pops</code> null, paste in the <code>SOP Path</code> field

<li>
Else, type the path - <code>/obj/FX_particles/OUT_pops</code>

<li>
<code>Import Path Prefix</code> to set the location in the USD hierarchy:

<ul>
<li>
<code>/FX/particle_sim</code>

</ul>
</ul>
<li>
Add a <code>Merge</code> node below the Trees merge, and pipe-in the <code>particle_sim</code>.

</ul>
<div id="Particles in Solaris-Applying an Emissive Material (Particles)"><h2 id="Applying an Emissive Material (Particles)" class="header"><a href="#Particles in Solaris-Applying an Emissive Material (Particles)">Applying an Emissive Material (Particles)</a></h2></div>

<p>
After the <code>particle_sim</code> ('SOP Import') node:
</p>
<ul>
<li>
Add a <code>Material Library</code> node:

<ul>
<li>
Inside drop a <code>Karma Material Builder</code>

<ul>
<li>
Rename it to <code>emissive</code>

<li>
Inside the <code>Karma Material Builder</code>:

<ul>
<li>
We need to utilize the color (Cd), so Drop a <code>USD Prim Var Reader</code> node:

<ul>
<li>
Set the <code>Signature</code> to <code>Float 3</code>

<li>
In the Stage context, USD changes from using <code>Cd</code> for color, to <code>displayColor</code>:

<ul>
<li>
<code>Var Name</code> to <code>displayColor</code>

</ul>
<li>
Plug <code>result</code> into the <code>mtlxstandardsurface</code> node via the <code>Emission Color</code> input.

</ul>
</ul>
<li>
For the <code>mtlxstandardsurface</code> set:

<ul>
<li>
<code>Base</code> to 0

<li>
<code>Specular</code> to 0

<li>
<code>Emission</code> section:

<ul>
<li>
<code>Emission</code> slider to 50

</ul>
</ul>
</ul>
</ul>
<li>
Return to the Stage level, select the <code>Material Library</code>:

<ul>
<li>
<code>Auto-fill Materials</code>

<li>
<code>Material Path Prefix</code> to <code>/FX/particle_sim/materials/</code>

<li>
Remove the <code>Material Path</code> contents (leave blank so that it doesn't overwrite the Material path

<li>
<code>Geometry Path</code> to <code>/FX/particle_sim/points_0</code>:

<ul>
<li>
you can do this by dragging the FX/particle_sim/points_0 from the <code>Scene Graph Path</code> to the field.

</ul>
</ul>
</ul>
<p>
Rendering this in the Viewport with Karma CPU/XPU will result in a lot of noisy results. To help:
</p>
<ul>
<li>
Add a <code>Render Geometry Settings</code> node after the <code>Material Library</code>:

<ul>
<li>
<code>Primitives</code> to <code>/FX/particle_sim/points_0</code> (just like the 'Geometry Path' above)

<li>
Scroll all the way down to the <code>Light</code> section:

<ul>
<li>
Click on the drop-down menu at the head of <code>Treat as Light Source</code> and choose <code>Set or Create</code>

<li>
Set to <code>Yes</code>

</ul>
</ul>
</ul>
<div id="Particles in Solaris-Applying an Emissive Material (Particles)-Extra tip"><h4 id="Extra tip" class="header"><a href="#Particles in Solaris-Applying an Emissive Material (Particles)-Extra tip">Extra tip</a></h4></div>
<ul>
<li>
To affect the size of the particles:

<li>
<span id="Particles in Solaris-Applying an Emissive Material (Particles)-Extra tip-NOTE"></span><strong id="NOTE">NOTE</strong>: the <code>pscale</code> variable becomes <code>widths</code> in the USD context:

<ul>
<li>
Drop an <code>Attribute Wrangle</code> after the <code>Render Geometry Settings</code> node:

<ul>
<li>
Check 'On' <code>Run on Elements of Array Attributes</code>

<li>
VEXpression <code>@widths *= ch("pscale_adjust");</code> and click on the 'make channel' icon (slider and '+')

<li>
This gives a slider parameter labelled <code>Pscale Adjust</code>:

<ul>
<li>
This is a multiplier for the particle size

<li>
Set to 0.5 (or anything but zero!)

</ul>
</ul>
</ul>
</ul>
<div id="Particles in Solaris-Applying an Emissive Material (Particles)-Denoising the Viewport Karma Rendering"><h3 id="Denoising the Viewport Karma Rendering" class="header"><a href="#Particles in Solaris-Applying an Emissive Material (Particles)-Denoising the Viewport Karma Rendering">Denoising the Viewport Karma Rendering</a></h3></div>

<p>
<span id="Particles in Solaris-Applying an Emissive Material (Particles)-Denoising the Viewport Karma Rendering-NOTE"></span><strong id="NOTE">NOTE</strong>: <em>NOT AVAILABLE ON MACOS</em>
</p>
<div id="Particles in Solaris-Applying an Emissive Material (Particles)-Denoising the Viewport Karma Rendering-[[https://www.sidefx.com/docs/houdini/render/optixdenoiser.html|NVIDIA OptiX denoiser]]"><h4 id="[[https://www.sidefx.com/docs/houdini/render/optixdenoiser.html|NVIDIA OptiX denoiser]]" class="header"><a href="#Particles in Solaris-Applying an Emissive Material (Particles)-Denoising the Viewport Karma Rendering-[[https://www.sidefx.com/docs/houdini/render/optixdenoiser.html|NVIDIA OptiX denoiser]]"><a href="https://www.sidefx.com/docs/houdini/render/optixdenoiser.html">NVIDIA OptiX denoiser</a></a></h4></div>
<ul>
<li>


<li>
<code>D</code> key in the Viewport to bring up the settings:

<ul>
<li>
<code>Render</code> tab:

<li>
Switch <code>Show Options for</code> drop down from <code>HoudiniGL</code> to <code>Karma CPU</code> or <code>Karma XPU</code>

<ul>
<li>
<code>Basic</code> tabs:

<li>
check 'On' <code>Enable Denoising</code>

</ul>
</ul>
</ul>
<div id="Render Settings &amp; AOVs"><h1 id="Render Settings &amp; AOVs" class="header"><a href="#Render Settings &amp; AOVs">Render Settings &amp; AOVs</a></h1></div>
<div id="Render Settings &amp; AOVs-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=15664s|YouTube - timecode 04:21:04]]"><h4 id="[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=15664s|YouTube - timecode 04:21:04]]" class="header"><a href="#Render Settings &amp; AOVs-[[https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=15664s|YouTube - timecode 04:21:04]]"><a href="https://www.youtube.com/watch?v=3BX97YIQERE&amp;t=15664s">YouTube - timecode 04:21:04</a></a></h4></div>

<p>
After the <code>Karma Fog Box</code> node:
</p>
<ul>
<li>
Add a <code>Karma Render Settings</code> node:

<ul>
<li>
Set the <code>Camera</code> field to the scene camera (you can use the drop-down - <code>/orbit/cam1</code>)

<li>
You can change the resolution if required

<li>
Set <code>Engine Settings</code> - <code>CPU Parameters</code> or <code>XPU Parameters</code>

<ul>
<li>
In <code>CPU Parameters</code>:

<ul>
<li>
<code>Primary Samples</code> (default is 9)

<li>
Unless you change <code>Advanced</code> &gt; <code>Sampling</code> &gt; <code>Convergence Mode</code> to <code>Path Traced</code> (<code>Automatic</code> is default)

<ul>
<li>
<code>Path Traced Samples</code> to whatever is required; maybe <code>256</code>

</ul>
</ul>
<li>
In <code>XPU Parameters</code>:

<ul>
<li>
<code>Path Traced Samples</code> to whatever is required; maybe <code>256</code>

</ul>
</ul>
<li>
Other info:

<ul>
<li>
There are new extra controls for <code>XPU</code> renders:

<ul>
<li>
<code>Advanced</code> tab &gt; <code>Sampling</code> tab: but the defaults are probably OK for most.

</ul>
<li>
<code>Rendering</code> tab &gt; <code>Sampling</code> tab <code>Volumes and Opacity</code>:

<ul>
<li>
<code>Volume Step Rate</code> - adjust when there are overlapping voxels (like two explosions)

<li>
Increase for faster but less accurate 

</ul>
<li>
<code>Rendering</code> tab &gt; <code>Limits</code> tab:

<ul>
<li>
Set the 'stop' tracing limits:

<ul>
<li>
for example: <code>Refraction Limit</code> to 2 for our shot.

<li>
<code>SSS Limit</code> (subsurface scattering) could be bumped up to 1 (to get more brights in the leaves)

<li>
<code>Volume Limit</code> could be upped to 1 (to help the lighting of the fog by the particles):

<ul>
<li>
Note: this is more useful if emissive objects (materials) is set to NOT be a light source.

<li>
In our scene we have the emissive material of the particles set to be a light source, so not so useful to move above zero for <code>Volume Limit</code>

<li>
To see the affect, in our scene set the <code>Karma Physical Sky</code> light to intensity of zero.

</ul>
<li>
<code>Color Limit</code> is a cap on material brightness:

<ul>
<li>
For example, if our emissive is set to 50, it will be 'capped' to this limit value.

<li>
This is an issue when saving bright samples for compositing:

<ul>
<li>
Capping will limit the value availability, but might prevent sparkling or flickering of super brights.

</ul>
<li>
The default is 10

</ul>
</ul>
</ul>
<li>
<code>Rendering</code> tab &gt; <code>Camera Effects</code>:

<ul>
<li>
<code>Enable Depth of Field</code>

</ul>
<li>
<code>Rendering</code> tab &gt; <code>Camera Effects</code>:

<ul>
<li>
<code>Motion Blur</code> checkbox:

<ul>
<li>
<code>Velocity Blur</code>

<ul>
<li>
You can use <code>Stage</code> motion or use existing <code>velocity</code> data

</ul>
<li>
In our case we should set <code>Instance Velocity Blur</code> to <code>Velocity Blur</code> for our particles

</ul>
</ul>
<li>
<code>Rendering</code> tab &gt; <code>Geometry and Shading</code>: 

<ul>
<li>
<code>Dicing</code> section:

<ul>
<li>
Affects quality of displacement

<li>
Increasing <code>Dicing Quality Scale</code> will make for more subdivisions at render time.

<li>
If quality is fine from the existing geometry, keep this low.

</ul>
</ul>
<li>
<code>Rendering</code> tab &gt; <code>Image Output</code>:

<ul>
<li>
<code>AOVs (Render Vars)</code>:

<li>
Here you can set AOV outputs

<li>
You can choose to have separated lights with <code>Split per LPE Tag</code>:

<ul>
<li>
You have to give individual or groups of lights an <code>LPE Tag</code>:

<ul>
<li>
These are entered in the <code>Karma</code> tab &gt; <code>Light</code> section &gt; <code>LPE Tag</code> field (which has to be activated - with Set and Create.

<li>
Perhaps <code>rim_lights</code> for example

</ul>
</ul>
<li>
Some AOV options:

<ul>
<li>
Beauty:

<ul>
<li>
Beauty

<li>
Beauty Unshadowed

<li>
Shadow

</ul>
<li>
Diffuse:

<ul>
<li>
Combined Diffuse

<li>
Direct Diffuse

<li>
Indirect Diffuse

<li>
Combined Diffuse Unshadowed

<li>
Direct Diffuse Unshadowed

<li>
Indirect Diffuse Unshadowed

<li>
Combined Diffuse Shadow

<li>
Direct Diffuse Shadow

<li>
Indirect Diffuse Shadow

</ul>
<li>
Reflections and Refractions:

<ul>
<li>
Combined Glossy Reflection

<li>
Direct Glossy Reflection

<li>
Indirect Glossy Reflection

<li>
Glossy Transmission

<li>
BSDF Labelled 'coat'

</ul>
<li>
Lights and Emission:

<ul>
<li>
Combined Emission

<li>
Direct Emission

<li>
Indirect Emission

<li>
Visible Lights

</ul>
<li>
Volume:

<li>
SSS:

<li>
Albedo:

<li>
Ambient Occlusion:

<li>
Utility:

<ul>
<li>
P (World Space)

<li>
P (Camera Space)

<li>
Depth (Camera Space)

<li>
Texture Coordinates (st)

<li>
N (Smooth Normals)

<li>
Ng (Geometric Normal)

<li>
Facing Ratio (N.I)

<li>
Geometric Facing Ratio (Ng.I)

<li>
Motion Vectors

<li>
Velocity

</ul>
<li>
Extra Render Vars:

<ul>
<li>
(Custom)

<li>
You don't need to install anything extra for Cryptomatte:

<li>
Cryptomatte - you have to add an <code>Extra Render Var</code> and select these from the drop-down:

<ul>
<li>
Cryptomatte (Texture Name)

<li>
Cryptomatte (Object Name)

</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
<p>
You can select AOVs to include in the render, and then after a Viewport preview render (with Karma), you can look at them using the AOV icon tool on the right side of the Viewport (a layered file icon). Click on the icon and choose the AOV to review.
</p>


<div id="Render Settings &amp; AOVs-Preventing the Karma Physical Sky Light showing up as a Sky in AOV"><h3 id="Preventing the Karma Physical Sky Light showing up as a Sky in AOV" class="header"><a href="#Render Settings &amp; AOVs-Preventing the Karma Physical Sky Light showing up as a Sky in AOV">Preventing the Karma Physical Sky Light showing up as a Sky in AOV</a></h3></div>

<p>
For the <code>Karma Physical Sky</code> light, turn off the <code>Render Light Geometry</code> to prevent it showing up in the visible light AOV.
</p>

<div id="Render Settings &amp; AOVs-Karma Fog Box and Depth Pass"><h3 id="Karma Fog Box and Depth Pass" class="header"><a href="#Render Settings &amp; AOVs-Karma Fog Box and Depth Pass">Karma Fog Box and Depth Pass</a></h3></div>

<p>
You need to render things like the <code>Depth</code> pass with the <code>Karma Fog Box</code> disabled, to get a clean depth pass.
</p>

<div id="Render Settings &amp; AOVs-Camera Edit Node"><h3 id="Camera Edit Node" class="header"><a href="#Render Settings &amp; AOVs-Camera Edit Node">Camera Edit Node</a></h3></div>
<p>
You can use a <code>Camera Edit</code> node also:
</p>
<ul>
<li>
Drop it before the 'Karma Render Settings`:

<ul>
<li>
<code>Primitives</code> to the scene camera

<li>
In the Viewport, <code>&lt;enter&gt;</code> to activate camera 'handles' (tools):

<ul>
<li>
you can <code>&lt;shift&gt; F</code> to activate the focus plane tool

<li>
<code>&lt;shift&gt; LMB</code> on items to set the focus plane at the selection's distance from the camera

</ul>
<li>
To use the values:

<ul>
<li>
<code>Sampling</code> tab:

<ul>
<li>
 For <code>Focus Distance</code> which will be grayed out - <code>LMB click</code> on the widget and choose <code>Set or Create</code>

<li>
Same for <code>F-Stop</code> parameter:

<ul>
<li>
Zero is 'off' for <code>F-Stop</code>, then values are F-stop

</ul>
</ul>
</ul>
</ul>
</ul>
<p>
<br>
<br>
<a href="Houdini.html">Houdini</a>
</p>

<p>
<a href="index.html">index</a>
</p>

</body>
</html>
