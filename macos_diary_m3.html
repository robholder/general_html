<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<title>macos_diary_m3</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<p>
<a href="index.html">index</a>
</p>

<p>
<a href="macos.html">MacOS</a>
</p>

<div id="MacBook Diary - Macbook Pro M3"><h1 id="MacBook Diary - Macbook Pro M3" class="header"><a href="#MacBook Diary - Macbook Pro M3">MacBook Diary - Macbook Pro M3</a></h1></div>



<div id="MacBook Diary - Macbook Pro M3-Shell/Terminal"><h2 id="Shell/Terminal" class="header"><a href="#MacBook Diary - Macbook Pro M3-Shell/Terminal">Shell/Terminal</a></h2></div>
<p>
Bash sources .bash_profile, not .bashrc when loading.
</p>

<p>
To change between shells:
</p>

<pre bash>
chsh -s /bin/zsh
chsh -s /bin/bash
chsh -s /bin/tcsh
</pre>

<p>
Zsh &amp; Bash use different syntax for formatting and coloring prompts.
</p>

<div id="MacBook Diary - Macbook Pro M3-Shell/Terminal-Changing Login Account details"><h3 id="Changing Login Account details" class="header"><a href="#MacBook Diary - Macbook Pro M3-Shell/Terminal-Changing Login Account details">Changing Login Account details</a></h3></div>

<p>
I called my account ‘robertholder’ which was too long.
Make an alternative Admin account (AltAdmin perhaps).
Log into new alt admin account
Go to /Users and change the account directory (robertholder folder) to the new name (noddy)
Back in the Users &amp; Groups panel, Ctrl-click on the original account 
Change account and home directory to match the new ones:
Change name of account (from robertholder to noddy)
Change name of original home dir, /Users/robertholder folder to /Users/noddy.
Reboot, and log into the newly changed account.
</p>

<div id="MacBook Diary - Macbook Pro M3-Shell/Terminal-Dropbox hiccup"><h3 id="Dropbox hiccup" class="header"><a href="#MacBook Diary - Macbook Pro M3-Shell/Terminal-Dropbox hiccup">Dropbox hiccup</a></h3></div>
<p>
I found that Dropbox could no longer find its location.
</p>
<ul>
<li>
Open your Terminal app (Located at /Applications/Utilities/Terminal)

<li>
Exactly run this command (it’ll ask for password):
	sudo mv ~/.dropbox ~/.Trash/dropbox.old

<li>
Restart Dropbox (from the Applications folder)

<li>
Sign in again to finish setup

</ul>
<div id="MacBook Diary - Macbook Pro M3-Vim"><h2 id="Vim" class="header"><a href="#MacBook Diary - Macbook Pro M3-Vim">Vim</a></h2></div>
<p>
Vim looked terrible in the macOS Terminal app. So I installed MacVim again (like on my other MacBook).
</p>

<p>
I copied the .vim/vimrc and the rest of the .vim directory contents wholesale to the new MacBook.
</p>

<p>
Vim-airline
I had to download ‘patched’ fonts for ‘vim-airline’ panel plugin:
</p>

<p>
<a href="https://vi.stackexchange.com/questions/3359/how-do-i-fimx-the-status-bar-symbols-in-the-airline-plugin:">https://vi.stackexchange.com/questions/3359/how-do-i-fimx-the-status-bar-symbols-in-the-airline-plugin:</a>
</p>

<ul>
<li>
To add the correct patched fonts:

<ul>
<li>
Install in terminal like so...
<pre bash>
git clone https://github.com/powerline/fonts.git --depth=1
cd fonts
./install.sh
cd ..
rm -rf fonts
</pre>

</ul>
<li>
To remove or uninstall:

<ul>
<li>
Again, like install, in the terminal…
<pre bash>
git clone https://github.com/powerline/fonts.git --depth=1
cd fonts
./uninstall.sh
cd ..
rm -rf fonts
</pre>

</ul>
</ul>
<div id="MacBook Diary - Macbook Pro M3-Remapping Fn Keys for Keyboard Brightness"><h2 id="Remapping Fn Keys for Keyboard Brightness" class="header"><a href="#MacBook Diary - Macbook Pro M3-Remapping Fn Keys for Keyboard Brightness">Remapping Fn Keys for Keyboard Brightness</a></h2></div>
<p>
To list Fn keys:
</p>
<pre bash>
ioreg -l | grep FnFunctionUsageMap | grep -Eo "0x[0-9a-fA-F]+,0x[0-9a-fA-F]+"
</pre>


<p>
This changes the dictation/siri and Focus buttons to ‘up/down’ keyboard brightness:<br>
In:<br>
<code>~/Library/LaunchAgents/</code>
</p>


<p>
Create a file called:<br>
<code>com.local.KeyRemapping.plist</code>
</p>


<p>
Contents:
</p>
<pre html>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;
&lt;plist version="1.0"&gt;
&lt;dict&gt;
    &lt;key&gt;Label&lt;/key&gt;
    &lt;string&gt;com.local.KeyRemapping&lt;/string&gt;
    &lt;key&gt;ProgramArguments&lt;/key&gt;
    &lt;array&gt;
        &lt;string&gt;/usr/bin/hidutil&lt;/string&gt;
        &lt;string&gt;property&lt;/string&gt;
        &lt;string&gt;--set&lt;/string&gt;
        &lt;string&gt;{"UserKeyMapping":[
            {
              "HIDKeyboardModifierMappingSrc": 0xC000000CF,
              "HIDKeyboardModifierMappingDst": 0xFF00000009
            },
            {
              "HIDKeyboardModifierMappingSrc": 0x10000009B,
              "HIDKeyboardModifierMappingDst": 0xFF00000008
            }
        ]}&lt;/string&gt;
    &lt;/array&gt;
    &lt;key&gt;RunAtLoad&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</pre>

<p>
I want to change to Mission Control &amp; Spotlight (which I already have as a corner and a gesture swipe). Still looking
</p>

<div id="MacBook Diary - Macbook Pro M3-Screen Record With Internal Sound"><h2 id="Screen Record With Internal Sound" class="header"><a href="#MacBook Diary - Macbook Pro M3-Screen Record With Internal Sound">Screen Record With Internal Sound</a></h2></div>
<p>
<a href="https://github.com/ExistentialAudio/BlackHole">https://github.com/ExistentialAudio/BlackHole</a>
</p>
 
<ul>
<li>
Installed Blackhole driver (16ch)

<li>
Opened Audio Midi Setup

<li>
+ Created Aggregate device

<ul>
<li>
Called it “Blackhole Audio Input”

<li>
Choose BlackHole 16ch audio device

</ul>
<li>
+ Created Multi-Output Device

<ul>
<li>
Called it “Screen Recording With Audio”

<li>
Added ‘External Headphones’ (top)

<li>
Added ‘BlackHole 16ch’

<li>
Primary device, ‘External Headphones’

</ul>
<li>
In menu (or Sound system prefs) choose “Screen Recording With Audio”

<li>
Cntl+Shift+5

<li>
In Options (Quicktime screen cap floating window), choose:

<ul>
<li>
“BlackHole Audio Input”

<li>
Record

</ul>
<li>
Switch off in menu bar (it’ll save to the desktop by default).

</ul>
<div id="MacBook Diary - Macbook Pro M3-Installed Homebrew"><h2 id="Installed Homebrew" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installed Homebrew">Installed Homebrew</a></h2></div>

<pre bash>
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
# Then:
(echo; echo 'eval "$(/opt/homebrew/bin/brew shellenv)"') &gt;&gt; /Users/noddy/.zprofile
    eval "$(/opt/homebrew/bin/brew shellenv)"
</pre>

<div id="MacBook Diary - Macbook Pro M3-Aliased python3 to python:"><h2 id="Aliased python3 to python:" class="header"><a href="#MacBook Diary - Macbook Pro M3-Aliased python3 to python:">Aliased python3 to python:</a></h2></div>
<pre bash>
alias python=‘python3’
</pre>

<div id="MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)"><h2 id="Installed MacPorts (Failed to get any use)" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)">Installed MacPorts (Failed to get any use)</a></h2></div>
<p>
<a href="https://www.macports.org/install.php">https://www.macports.org/install.php</a>
</p>

<p>
Downloaded and installed:<br>
macOS Sonoma v14
</p>

<div id="MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)-Installed Gnucash (Failed)"><h4 id="Installed Gnucash (Failed)" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)-Installed Gnucash (Failed)">Installed Gnucash (Failed)</a></h4></div>
<p>
<a href="https://wiki.gnucash.org/wiki/Python_Bindings">https://wiki.gnucash.org/wiki/Python_Bindings</a>
</p>

<pre bash>
sudo port install gnucash +python3.6
(Loads of dependencies installed - took ages - literally hours, then failled. I have no idea how to fix.)
</pre>

<p>
To see what Pythons have been installed by MacPorts:<br>
</p>
<pre bash>
port select --list python
</pre>

<p>
I retained the list of packages that MacPorts was going to install for GnuCash (copied from terminal), and made an uninstall script with all of them on there!:<br>
Dry run version: (first couple of lines - more like 534 lines!)<br>
</p>
<pre bash>
port -y uninstall --follow-dependents Xft2
port -y uninstall --follow-dependents XviD
Blah, blah…
</pre>

<p>
Then full version (run in shell with sudo -s &lt;name of script file&gt;.sh - also ran chmod +x on the script)<br>
</p>
<pre bash>
port uninstall --follow-dependents Xft2
port uninstall --follow-dependents XviD
Blah, blah…
</pre>

<div id="MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)-Uninstalled MacPorts"><h3 id="Uninstalled MacPorts" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)-Uninstalled MacPorts">Uninstalled MacPorts</a></h3></div>

<p>
<a href="https://guide.macports.org/chunked/installing.macports.uninstalling.html">https://guide.macports.org/chunked/installing.macports.uninstalling.html</a>
</p>

<p>
Installed Xcode<br>
App Store &gt; Xcode<br>
Then in terminal:<br>
INPUT:<br>
</p>
<pre bash>
xcode-select --install
</pre>
<p>
OUTPUT:<br>
xcode-select: note: Command line tools are already installed. Use "Software Update" in System Settings or the softwareupdate command line interface to install updates<br>
</p>
 
<pre bash>
sudo xcodebuild -license
(Password entered, license shown, ‘agree’ typed)
</pre>

<p>
Reinstalled MacPorts<br>
Using pkg as downloaded for Sonoma.<br>
Then in terminal:<br>
</p>
<pre bash>
sudo port selfupdate
</pre>
<p>
Then (as prompted)
</p>
<pre bash>
sudo port upgrade outdated
(Nothing to upgrade.)
</pre>

<div id="MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)-Trying GnuCash with Python bindings again"><h3 id="Trying GnuCash with Python bindings again" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installed MacPorts (Failed to get any use)-Trying GnuCash with Python bindings again">Trying GnuCash with Python bindings again</a></h3></div>

<pre bash>
noddy@M3MacBookPro in ~/
$ sudo port install gnucash +python36 
Password:
---&gt;  Computing dependencies for gnucashpython36 is known to fail. Try to install anyway? [y/N]: N
Error: python36 is known to fail
Error: Follow https://guide.macports.org/#project.tickets if you believe there is a bug.
Error: Processing of port gnucash failed
</pre>
<p>
With tweak:
</p>
<pre bash>
sudo port install gnucash +python3.6

export PYTHONPATH=$PYTHONPATH:/opt/local/lib/python3.12/site-packages
</pre>

<p>
To remove?
</p>
<pre bash>
export PYTHONPATH="" &amp;&amp; source ~/.zshrc
</pre>


<pre bash>
$ port select --list python
Available versions for python:
	none (active)
	python27
	python310
	python311
	python312
</pre>

<p>
To activate:
</p>
<pre bash>
$ sudo port select --set python python27
</pre>
<p>
To deactivate:
</p>
<pre bash>
$ sudo port select --set python none
</pre>

<p>
The GnuCash - qb-escape modules just segment fault.<br>
Removing everything from MacPort installs.<br>
</p>

<div id="MacBook Diary - Macbook Pro M3-Uninstalling all Macport installations"><h2 id="Uninstalling all Macport installations" class="header"><a href="#MacBook Diary - Macbook Pro M3-Uninstalling all Macport installations">Uninstalling all Macport installations</a></h2></div>
<pre bash>
sudo port -fp uninstall --follow-dependents installed
</pre>
<p>
(See below that alterations to the .zprofile config was still causing problems down the line!)
</p>

<div id="MacBook Diary - Macbook Pro M3-Using Automator on M3MacBook"><h2 id="Using Automator on M3MacBook" class="header"><a href="#MacBook Diary - Macbook Pro M3-Using Automator on M3MacBook">Using Automator on M3MacBook</a></h2></div>

<p>
I wanted to set up the same python scripted ‘Quick Actions’ (RMB-menu) as on my old system.<br>
Things like add date as prefix, and replace spaces with underscores.<br>
</p>

<p>
In the ‘Runs as script’ option, the path to python had changed from Mojave to Sonoma. Now it’s:
</p>
<pre bash>
/usr/local/bin/python or python3.
# It used to be:
/usr/bin/python
</pre>

<p>
I added a sym-link in /usr/local/bin/:
</p>
<pre bash>
cd /usr/local
sudo mkdir bin
cd bin
sudo ln -sf /usr/bin/python3 /usr/local/bin/python
</pre>

<p>
Then in Automator, I chose /usr/local/bin/python as the ‘shell’ option.<br>
</p>

<p>
The Mac responded with a prompt/dialog window to install developer tools. I said yes.<br>
“The software was installed” was indicated.<br>
I ran the quick action again, and was asked to install AGAIN. I did.<br>
<br>
</p>

<p>
<a href="https://apple.stackexchange.com/questions/415563/repeatedly-being-asked-to-install-command-line-tools">https://apple.stackexchange.com/questions/415563/repeatedly-being-asked-to-install-command-line-tools</a>
</p>

<pre bash>
sudo xcode-select -switch /Library/Developer/CommandLineTools
</pre>

<p>
Didn’t work. The script can’t locate python.
</p>

<div id="MacBook Diary - Macbook Pro M3-Another attempt at the symlink:"><h2 id="Another attempt at the symlink:" class="header"><a href="#MacBook Diary - Macbook Pro M3-Another attempt at the symlink:">Another attempt at the symlink:</a></h2></div>
<pre bash>
sudo ln -s /usr/bin/python3 /usr/local/bin/python
</pre>
<p>
Then I got:
</p>
<pre bash>
/usr/local/bin/python --version
xcode-select: Failed to locate 'python', requesting installation of command line developer tools.
</pre>

<p>
So…<br>
<a href="https://osxdaily.com/2023/04/26/fix-xcode-select-error-active-developer-directory-on-mac/">https://osxdaily.com/2023/04/26/fix-xcode-select-error-active-developer-directory-on-mac/</a>
</p>

<p>
Solution 4: Install Xcode into /Applications, Switch Directory Accordingly
And finally, another solution that has worked for some users when the above approaches do not work, is to install Xcode from the Mac App Store into the /Applications/ directory on the Mac. After Xcode is installed on the Mac, open the Terminal and enter the following path:
</p>
<pre bash>
sudo xcode-select -s /Applications/Xcode.app/Contents/Developer
</pre>

<p>
Didn’t work:
</p>
<pre bash>
$ /usr/local/bin/python --version
python: error: Failed to locate 'python'.
xcode-select: Failed to locate 'python', requesting installation of command line developer tools.
</pre>

<p>
Didn’t work. Keeps asking for command line tools to be installed, when they already are.
</p>

<div id="MacBook Diary - Macbook Pro M3-Installing Python 3.12 from Python.org"><h2 id="Installing Python 3.12 from Python.org" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installing Python 3.12 from Python.org">Installing Python 3.12 from Python.org</a></h2></div>

<p>
<a href="https://www.python.org/downloads/release/python-3121/">https://www.python.org/downloads/release/python-3121/</a>
</p>


<div id="MacBook Diary - Macbook Pro M3-Installing Python 3.12 from Python.org-“Rename” install"><h3 id="“Rename” install" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installing Python 3.12 from Python.org-“Rename” install">“Rename” install</a></h3></div>
<p>
This is the command prompt bin to rename files:
</p>
<pre bash>
brew install rename
</pre>

<p>
To rename like the olden days version, use the -s flag:
</p>
<pre bash>
rename -s &lt;old-string&gt; &lt;new-string&gt; &lt;file-search-term&gt;

# Example:
rename -s test temp test*
</pre>

<div id="MacBook Diary - Macbook Pro M3-Pygame in a Venv"><h2 id="Pygame in a Venv" class="header"><a href="#MacBook Diary - Macbook Pro M3-Pygame in a Venv">Pygame in a Venv</a></h2></div>
<p>
I hit a snag where trying to install pygame into a virtual environment was actually installing into the system.
I changed two issues:
</p>
<ul>
<li>
.zprofile had been altered by a previous (useless) MacPorts installation - effectively hardwiring things to the system Python

<li>
Aliases for pip and python were pointing directly to binary paths rather than just pip3 and python3, so invoking the actual system.

</ul>
<div id="MacBook Diary - Macbook Pro M3-Pyinstaller &amp; Create-DMG"><h2 id="Pyinstaller &amp; Create-DMG" class="header"><a href="#MacBook Diary - Macbook Pro M3-Pyinstaller &amp; Create-DMG">Pyinstaller &amp; Create-DMG</a></h2></div>

<p>
To make standalone apps/executables from Python scripts.
</p>

<p>
Homebrew doesn’t install into virtual-ends. It has to be system (Python) wide. We need to install ‘create-dmg’ with Homebrew.
</p>

<p>
Ran (in terminal):
</p>
<pre bash>
brew install create-dmg
</pre>

<div id="MacBook Diary - Macbook Pro M3-Pyinstaller &amp; Create-DMG-240530"><h3 id="240530" class="header"><a href="#MacBook Diary - Macbook Pro M3-Pyinstaller &amp; Create-DMG-240530">240530</a></h3></div>

<div id="MacBook Diary - Macbook Pro M3-Removing old version of Python (from home-brew):"><h2 id="Removing old version of Python (from home-brew):" class="header"><a href="#MacBook Diary - Macbook Pro M3-Removing old version of Python (from home-brew):">Removing old version of Python (from home-brew):</a></h2></div>
<p>
Doing this to ready for Pyenv python version management (see below)
</p>

<p>
Find version:
</p>
<pre bash>
which python3
# /opt/homebrew/bin/
ll | grep python
# look for versions
</pre>

<p>
Uninstall:
</p>

<p>
Tried:
</p>
<pre bash>
brew uninstall python@3.12.3
</pre>
<p>
..but go error here:
</p>
<pre bash>
###################################
Error: Refusing to uninstall /opt/homebrew/Cellar/python@3.12/3.12.3
because it is required by glib and qemu, which are currently installed.
You can override this and force removal with:
  brew uninstall --ignore-dependencies python@3.12
###################################
</pre>

<pre bash>
brew uninstall --ignore-dependencies python@3.12
</pre>
<p>
then:
</p>
<pre bash>
brew cleanup python@3.12
</pre>

<p>
I had one more version in /usr/local/bin/python3:
</p>
<pre bash>
sudo rm /usr/local/bin/python3
</pre>

<div id="MacBook Diary - Macbook Pro M3-Removing old version of Python (from home-brew):-240530"><h3 id="240530" class="header"><a href="#MacBook Diary - Macbook Pro M3-Removing old version of Python (from home-brew):-240530">240530</a></h3></div>
<div id="MacBook Diary - Macbook Pro M3-PyEnv"><h2 id="PyEnv" class="header"><a href="#MacBook Diary - Macbook Pro M3-PyEnv">PyEnv</a></h2></div>
<p>
In Terminal:
</p>
<pre bash>
$ brew install openssl readline sqlite3 xz zlib
</pre>

<p>
…followed by: DIDN’T WORK - IGNORING
</p>
<pre bash>
$ sudo installer -pkg /Library/Developer/CommandLineTools/Packages/macOS_SDK_headers_for_macOS_10.14.pkg -target /
</pre>

<p>
Installing pyenv:
</p>
<pre bash>
$ curl https://pyenv.run | bash
</pre>

<p>
Added to .zshrc:
</p>
<pre bash>
#######################################
# 240530
# Added for Pyenv
export PYENV_ROOT="$HOME/.pyenv"
[[ -d $PYENV_ROOT/bin ]] &amp;&amp; export PATH="$PYENV_ROOT/bin:$PATH"
eval "$(pyenv init -)"

eval "$(pyenv virtualenv-init -)"
#######################################

Running pyenv in new shell:
{{{bash
$pyenv
</pre>
<p>
Pyenv 2.4.1
</p>

<pre bash>
$ pyenv version
&gt;system (set by /Users/noddy/.pyenv/version)
</pre>

<p>
Installing another Python version (-v is verbose, not version!):
</p>
<pre bash>
$ pyenv install -v 3.12.3
</pre>

<p>
This is now here:<br>
/Users/&lt;user&gt;/.pyenv/versions/
</p>

<pre bash>
$ ls /Users/&lt;user&gt;/.pyenv/version/
3.12.3
</pre>

<p>
The versions can be removed with:
</p>
<pre bash>
$ rm /Users/&lt;user&gt;/.pyenv/versions/3.12.3
</pre>
<p>
…or
</p>
<pre bash>
$ pyenv uninstall 3.12.3
</pre>

<p>
To see all version installed:
</p>
<pre bash>
Pyenv versions
* system
	3.12.3
</pre>

<p>
To see which version is ‘Live’:
</p>
<pre bash>
$ pyenv versions
(Look to see which version has the asterisk)
$ pyenv version
(To show which version is running/chosen.)
</pre>

<p>
To switch to a version:
</p>
<pre bash>
$ pyenv global 3.12.3
</pre>

<p>
To switch back to the system version:
</p>
<pre bash>
$ pyenv global system
</pre>

<div id="MacBook Diary - Macbook Pro M3-PyEnv-240601"><h3 id="240601" class="header"><a href="#MacBook Diary - Macbook Pro M3-PyEnv-240601">240601</a></h3></div>
<div id="MacBook Diary - Macbook Pro M3-Python /usr/local/bin Emergency"><h2 id="Python /usr/local/bin Emergency" class="header"><a href="#MacBook Diary - Macbook Pro M3-Python /usr/local/bin Emergency">Python /usr/local/bin Emergency</a></h2></div>

<p>
I tried running a “Quick Action” (right-click Automator script) and it failed. Looking at the script in Automator, it points to /usr/local/bin/python3.
</p>

<p>
However, I had broken symlinks to a deleted version of Python (3.12.1 or something). I’d removed this when preparing for my PyEnv set up.
First thing I did was to delete all the broken symlinks (things like pip3 etc. to the rogue version).
</p>

<p>
To get the Automator script working (I had a homemade one to add a date prefix and fill spaces with underscores), I added a symlink from the python3 in /usr/bin/:
</p>

<pre bash>
$ sudo ln -s /usr/bin/python3 /usr/local/bin/python3
</pre>

<p>
The Quick Action works, but I can’t help thinking things aren’t good in /usr/local/bin/…
</p>

<p>
For luck, I added pip3:
</p>

<pre bash>
$ sudo ln -s /usr/bin/pip3 /usr/local/bin/pip3
</pre>

<div id="MacBook Diary - Macbook Pro M3-Python /usr/local/bin Emergency-240602"><h3 id="240602" class="header"><a href="#MacBook Diary - Macbook Pro M3-Python /usr/local/bin Emergency-240602">240602</a></h3></div>
<div id="MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv"><h2 id="Python - wrong system version showing in Pyenv" class="header"><a href="#MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv">Python - wrong system version showing in Pyenv</a></h2></div>
<p>
Jeebuz-Nelly.
</p>


<p>
When running pyenv global system, the version of python was 3.12. The macOS Sonoma version should be 3.9.6.
Something’s wrong…
</p>

<div id="MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv-I removed pyenv:"><h4 id="I removed pyenv:" class="header"><a href="#MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv-I removed pyenv:">I removed pyenv:</a></h4></div>
<pre bash>
$ rm -rf ~/.pyenv
</pre>

<p>
<em>It failed with some blather about pyenv:12 or something.</em><br>
<em>I just continued to blast the ~/.pyenv it was gone.</em>
</p>

<div id="MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv-I ran this:"><h4 id="I ran this:" class="header"><a href="#MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv-I ran this:">I ran this:</a></h4></div>

<pre bash>
# The version of Python that you want to delete
python_version_number=3.12
sudo rm -rf /Library/Frameworks/Python.framework/Versions/${python_version_number}/
sudo rm -rf "/Applications/Python ${python_version_number}/"
cd /usr/local/bin &amp;&amp; ls -l | grep "/Library/Frameworks/Python.framework/Versions/${python_version_number}" | awk '{print $9}' | sudo xargs rm
</pre>


<p>
<span id="MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv-I ran this:-Next bit.."></span><strong id="Next bit..">Next bit..</strong> In the end, after deleting all the frameworks stuff below (which I made a mistake on, so I actually have NO frameworks Versions folder).
</p>

<p>
I should have done:
</p>

<pre bash>
$ sudo rm -rf /Library/Frameworks/Python.framework/Versions/3.12
$ ls -l /usr/local/bin | grep '../Library/Frameworks/Python.framework/Versions/3.12’
$ cd /usr/local/bin
$ ls -l /usr/local/bin | grep '../Library/Frameworks/Python.framework/Versions/3.12’ | awk '{print $9}' | tr -d @ | xargs rm*
</pre>

<p>
I did:
</p>
<pre bash>
$ sudo rm -rf /Library/Frameworks/Python.framework/Versions/[version number]
</pre>
<p>
(I had to make a new Versions directory: sudo mkdir Versions)<br>
</p>

<p>
Onwards. Getting to a clue:
Then, which python3 showed it was a home-brew version.
</p>
<div id="MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv-I ran:"><h4 id="I ran:" class="header"><a href="#MacBook Diary - Macbook Pro M3-Python - wrong system version showing in Pyenv-I ran:">I ran:</a></h4></div>
<pre bash>
$ brew uninstall python@3.12
</pre>

<p>
<em>However, it then said it had dependencies, like glib and stuff. So I ran the ignore flag as suggested in the shell.</em>
</p>

<p>
Ok, now which python3 says 3.9.6
I re-added a symlink from /usr/bin to /usr/local/bin
</p>
<pre bash>
$ sudo ln -s /usr/bin/python3 to /usr/local/bin/python3
</pre>

<p>
So now, my Quick Actions menu works and the which python3 command says 3.9.6.<br>
</p>

<p>
Now I’m going to reinstall pyenv with brew…<br>
</p>

<div id="MacBook Diary - Macbook Pro M3-Wine"><h2 id="Wine" class="header"><a href="#MacBook Diary - Macbook Pro M3-Wine">Wine</a></h2></div>
<p>
Installing with homebrew:
</p>

<pre bash>
$ brew install —cask wine-stable
</pre>

<div id="MacBook Diary - Macbook Pro M3-Wine-240622"><h3 id="240622" class="header"><a href="#MacBook Diary - Macbook Pro M3-Wine-240622">240622</a></h3></div>
<div id="MacBook Diary - Macbook Pro M3-Installed ‘tree’ for the terminal"><h2 id="Installed ‘tree’ for the terminal" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installed ‘tree’ for the terminal">Installed ‘tree’ for the terminal</a></h2></div>
<pre bash>
$ brew install tree
</pre>

<p>
This allows for a graphical layout of directories and files in the terminal:
</p>
<pre bash>
$ tree
.
├── README.md
├── circle_02
│   ├── __init__.py
│   └── icons
│       └── circle32.png
└── move_01.py

=== 240623 ===

Command history wasn’t working with Cntl-R in my zsh. Apparently it might be the vi mode.&lt;br&gt;

This made is work:
{{{bash
bindkey -v
bindkey '^R' history-incremental-search-backward
</pre>

<div id="MacBook Diary - Macbook Pro M3-Installed ‘tree’ for the terminal-240723"><h3 id="240723" class="header"><a href="#MacBook Diary - Macbook Pro M3-Installed ‘tree’ for the terminal-240723">240723</a></h3></div>
<div id="MacBook Diary - Macbook Pro M3-TkInter hell"><h2 id="TkInter hell" class="header"><a href="#MacBook Diary - Macbook Pro M3-TkInter hell">TkInter hell</a></h2></div>

<p>
Doing a tutorial from:<br>
<a href="https://www.pythonguis.com/tutorials/create-gui-tkinter/">https://www.pythonguis.com/tutorials/create-gui-tkinter/</a>
</p>

<pre bash>
brew install python-tk
</pre>

<p>
Realized my system python is crapped out again. Somehow I’m back to having 3.12 as system python (should be 3.9 with Sonoma).
I switched to pyenv global 3.11.9
</p>
<pre bashj>
pyenv global 3.11.9
</pre>
<p>
Then installed python-tk@3.11
</p>
<pre bashj>
brew install python-tk@3.11
</pre>
<p>
Nothing works - lost 3.9 python and tkinter doesn’t work in 3.11.
</p>

<p>
Ok.. I’ve found that the pyenv thing was seeing python 3.12.4 as the system version. And it wasn’t working properly as it said pip was missing.
</p>

<p>
Eventually I removed this weird version:
</p>
<pre bashj>
brew uninstall python@3.12
</pre>

<p>
Running Python again reverted to 3.9.6… yeah!!!
I might be back on track.
</p>

<p>
I removed the new rogue versions of tkinter too:
</p>
<pre bashj>
brew uninstall python
</pre>
<p>
and
</p>
<pre bashj>
brew uninstall python@3.12
</pre>

<p>
The native version of tkinter is completely broken on Sonoma.
</p>

<pre bashj>
DEPRECATION WARNING: The system version of Tk is deprecated… blah
</pre>


<div id="MacBook Diary - Macbook Pro M3-Trying to install TkInter with a pyenv python:"><h2 id="Trying to install TkInter with a pyenv python:" class="header"><a href="#MacBook Diary - Macbook Pro M3-Trying to install TkInter with a pyenv python:">Trying to install TkInter with a pyenv python:</a></h2></div>

<p>
<a href="https://dev.to/xshapira/using-tkinter-with-pyenv-a-simple-two-step-guide-hh5">https://dev.to/xshapira/using-tkinter-with-pyenv-a-simple-two-step-guide-hh5</a>
</p>

<p>
Switched to system python (3.9.6) in pyenv.
</p>
<pre bashj>
brew install tcl-tk
</pre>

<p>
I missed this command.. oops (didn’t run it at all and moved to the next block, but my install still worked).
</p>

<pre bashj>
brew install openssl readline sqlite3 xz zlib
</pre>

<p>
I used the latest python at the end of this command (but you can install any version of python to use the tk install:
</p>

<pre bashj>
env LDFLAGS="-L$(brew --prefix openssl@1.1)/lib -L$(brew --prefix readline)/lib -L$(brew --prefix sqlite3)/lib -L$(brew --prefix xz)/lib -L$(brew --prefix zlib)/lib -L$(brew --prefix tcl-tk)/lib" \
CPPFLAGS="-I$(brew --prefix openssl@1.1)/include -I$(brew --prefix readline)/include -I$(brew --prefix sqlite3)/include -I$(brew --prefix xz)/include -I$(brew --prefix zlib)/include -I$(brew --prefix tcl-tk)/include" \
PKG_CONFIG_PATH="$(brew --prefix openssl@1.1)/lib/pkgconfig:$(brew --prefix readline)/lib/pkgconfig:$(brew --prefix sqlite3)/lib/pkgconfig:$(brew --prefix xz)/lib/pkgconfig:$(brew --prefix zlib)/lib/pkgconfig:$(brew --prefix tcl-tk)/lib/pkgconfig" \
pyenv install 3.12.4
</pre>

<p>
I used pyenv to use the 3.12.4 Python and tkinter seemed to work.
</p>

<div id="MacBook Diary - Macbook Pro M3-Trying to install TkInter with a pyenv python:-240807"><h3 id="240807" class="header"><a href="#MacBook Diary - Macbook Pro M3-Trying to install TkInter with a pyenv python:-240807">240807</a></h3></div>

<div id="MacBook Diary - Macbook Pro M3-OhMyZsh"><h2 id="OhMyZsh" class="header"><a href="#MacBook Diary - Macbook Pro M3-OhMyZsh">OhMyZsh</a></h2></div>

<p>
Shell customization and what-not.<br>
Installed like so:
</p>

<pre bashj>
sh -c "$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"
</pre>

<p>
I looked at it for a minute, then reverted back to my normal zsh by renaming/moving the .zshrc files:
.zshrc -&gt; .zshrc-ohmyzsh
</p>
<pre bashj>
mv ~/.zshrc ~/zshrc-ohmyzsh
</pre>
<p>
Then move original .zshrc back in place:
</p>
<pre bashj>
mv ~/.zshrc.pre-oh-my-zsh ~/.zshrc
</pre>

<p>
Note:<br>
If you want to remove completely:
</p>
<pre bashj>
uninstall_oh_my_zsh
</pre>
<p>
Or:
</p>
<pre bashj>
sh ~/.oh-my-zsh/tools/uninstall.sh
</pre>

<div id="MacBook Diary - Macbook Pro M3-OhMyZsh-240829"><h3 id="240829" class="header"><a href="#MacBook Diary - Macbook Pro M3-OhMyZsh-240829">240829</a></h3></div>

<div id="MacBook Diary - Macbook Pro M3-Pygments (failed attempt at colored HTML in Vimwiki)"><h2 id="Pygments (failed attempt at colored HTML in Vimwiki)" class="header"><a href="#MacBook Diary - Macbook Pro M3-Pygments (failed attempt at colored HTML in Vimwiki)">Pygments (failed attempt at colored HTML in Vimwiki)</a></h2></div>

<p>
Pygments for Vimwiki color HTML syntax highlighting - can’t get it to work with vimwiki.
</p>

<pre bashj>
pip3 install pygments

Defaulting to user installation because normal site-packages is not writeable
Collecting pygments
  Using cached pygments-2.18.0-py3-none-any.whl.metadata (2.5 kB)
Using cached pygments-2.18.0-py3-none-any.whl (1.2 MB)
Installing collected packages: pygments
  WARNING: The script pygmentize is installed in '/Users/noddy/Library/Python/3.9/bin' which is not on PATH.
  Consider adding this directory to PATH or, if you prefer to suppress this warning, use --no-warn-script-location.
Successfully installed pygments-2.18.0
</pre>

<p>
In response to the WARNING above, I tried adding the path to the PATH env variable:
</p>

<pre bashj>
export PATH=/Users/noddy/Library/Python/3.9/bin:$PATH
</pre>

<p>
I put this into my .zshrc file too, and although Pygments and pygmentize work in isolation, they don’t work with vimwiki for me.
</p>

<div id="MacBook Diary - Macbook Pro M3-Pygments (failed attempt at colored HTML in Vimwiki)-Not working. :("><h4 id="Not working. :(" class="header"><a href="#MacBook Diary - Macbook Pro M3-Pygments (failed attempt at colored HTML in Vimwiki)-Not working. :(">Not working. :(</a></h4></div>

<pre bash<br>>
pip3 uninstall pygments
&gt;Found existing installation: Pygments 2.18.0
&gt;Uninstalling Pygments-2.18.0:
</pre>

<p>
Removed the export PATH line from the .zshrc.
</p>


<div id="MacBook Diary - Macbook Pro M3-Pygments (failed attempt at colored HTML in Vimwiki)-240918"><h3 id="240918" class="header"><a href="#MacBook Diary - Macbook Pro M3-Pygments (failed attempt at colored HTML in Vimwiki)-240918">240918</a></h3></div>

<div id="MacBook Diary - Macbook Pro M3-Quick Look Plugins"><h2 id="Quick Look Plugins" class="header"><a href="#MacBook Diary - Macbook Pro M3-Quick Look Plugins">Quick Look Plugins</a></h2></div>

<p>
On my M3 Macbook, the 'Quick Look' preview (spacebar on a file in Finder), no longer shows '.srt' files. (My Intel Macbook - Mojave - shows them just fine.
</p>

<p>
I've read that the plugin system is changing to an API, but a reddit post said to look for 'brew' installs.
</p>

<div id="MacBook Diary - Macbook Pro M3-Quick Look Plugins-https://www.reddit.com/r/macapps/comments/1f00bbx/11_useful_plugins_for_quicklook/"><h5 id="https://www.reddit.com/r/macapps/comments/1f00bbx/11_useful_plugins_for_quicklook/" class="header"><a href="#MacBook Diary - Macbook Pro M3-Quick Look Plugins-https://www.reddit.com/r/macapps/comments/1f00bbx/11_useful_plugins_for_quicklook/"><a href="https://www.reddit.com/r/macapps/comments/1f00bbx/11_useful_plugins_for_quicklook/">https://www.reddit.com/r/macapps/comments/1f00bbx/11_useful_plugins_for_quicklook/</a></a></h5></div>

<pre bash>
brew search --desc "Quick Look plugin" | grep srt

# qladdict: (QLAddict) Quick Look plugin for subtitle (.srt) files
</pre>

<p>
Tried installing (then uninstalling):
</p>
<pre bash>
brew install —cask qladdict
brew uninstall —cask qladdict

brew install qladdict
brew uninstall qladdict

Didn’t work for me.
</pre>


<p>
<a href="macos.html">MacOS</a>
</p>

<p>
<a href="index.html">index</a>
</p>

</body>
</html>
