<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<title>unix_shell_zsh_scripting</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<p>
<a href="index.html">index</a>
</p>

<p>
<a href="unix_tools_index.html">Unix Tools</a>
</p>

<div id="Zsh Scripting"><h1 id="Zsh Scripting" class="header"><a href="#Zsh Scripting">Zsh Scripting</a></h1></div>

<p>
Below is a study guide that covers the most common conditional constructs, file and variable tests, and function syntax in zsh. This guide is designed to give you a broad overview of how to write robust zsh scripts with conditionals and functions.
</p>

<div id="Zsh Scripting-Zsh Basics"><h2 id="Zsh Basics" class="header"><a href="#Zsh Scripting-Zsh Basics">Zsh Basics</a></h2></div>

<div id="Zsh Scripting-Zsh Basics-Shebang and Script Entry Point"><h3 id="Shebang and Script Entry Point" class="header"><a href="#Zsh Scripting-Zsh Basics-Shebang and Script Entry Point">Shebang and Script Entry Point</a></h3></div>

<p>
Every script usually begins with a shebang line:
</p>

<pre zsh>
#!/usr/bin/env zsh
</pre>

<p>
This tells the system to use zsh as the interpreter.
</p>

<div id="Zsh Scripting-Zsh Basics-Defining Functions"><h3 id="Defining Functions" class="header"><a href="#Zsh Scripting-Zsh Basics-Defining Functions">Defining Functions</a></h3></div>

<p>
You can define functions in two common ways:
</p>

<pre zsh>
# Using the function keyword:
function my_function {
    echo "Hello from my_function"
}

# Or the shorthand syntax:
my_function2() {
    echo "Hello from my_function2"
}
</pre>

<p>
Functions can take parameters (accessed as \(1, \)2, â€¦) and can return numbers via the return command (typically 0 for success).
</p>

<div id="Zsh Scripting-Conditional Statements"><h2 id="Conditional Statements" class="header"><a href="#Zsh Scripting-Conditional Statements">Conditional Statements</a></h2></div>

<p>
Zsh offers a few ways to implement conditionals, most notably with if, else, elif, and even case statements.
</p>

<div id="Zsh Scripting-Conditional Statements-Basic If/Else Syntax"><h3 id="Basic If/Else Syntax" class="header"><a href="#Zsh Scripting-Conditional Statements-Basic If/Else Syntax">Basic If/Else Syntax</a></h3></div>

<p>
Using double square brackets (<a href=" .html"> .html</a>) is recommended because it offers extended test capabilities and more predictable behavior with globbing and regex:
</p>

<pre zsh>
if [[ condition ]]; then
    # commands if condition is true
elif [[ another_condition ]]; then
    # commands if the alternative condition is true
else
    # commands if none matched
fi
</pre>

<p>
Example: Testing a Variable Value
</p>

<pre zsh>
VAR="hello"
if [[ "$VAR" == "hello" ]]; then
    echo "VAR is hello"
else
    echo "VAR is not hello"
fi
</pre>

<div id="Zsh Scripting-Conditional Statements-Numeric Tests"><h3 id="Numeric Tests" class="header"><a href="#Zsh Scripting-Conditional Statements-Numeric Tests">Numeric Tests</a></h3></div>

<p>
For arithmetic comparisons, use the double-parentheses syntax:
</p>

<pre zsh>
num=15
if (( num &gt; 10 )); then
    echo "num is greater than 10"
else
    echo "num is 10 or less"
fi
</pre>

<div id="Zsh Scripting-Conditional Statements-Using the Traditional Test Command"><h3 id="Using the Traditional Test Command" class="header"><a href="#Zsh Scripting-Conditional Statements-Using the Traditional Test Command">Using the Traditional Test Command</a></h3></div>

<p>
You can use the [ ... ] (or its synonym test) but note that it has fewer features than <a href=" ... .html">...</a> and requires careful quoting:
</p>

<pre zsh>
if [ "$VAR" = "hello" ]; then
    echo "VAR is hello"
fi
</pre>

<p>
Modern scripts usually prefer <code>[[ ... ]]</code> to avoid many pitfalls.
</p>

<div id="Zsh Scripting-Testing Files and Directories"><h2 id="Testing Files and Directories" class="header"><a href="#Zsh Scripting-Testing Files and Directories">Testing Files and Directories</a></h2></div>

<p>
Zsh (like other POSIX shells) provides file test operators that work inside [ ] or <a href=" .html"> .html</a>.
</p>

<div id="Zsh Scripting-Testing Files and Directories-Common File Test Operators"><h3 id="Common File Test Operators" class="header"><a href="#Zsh Scripting-Testing Files and Directories-Common File Test Operators">Common File Test Operators</a></h3></div>

<ul>
<li>
<code>-e file</code>: True if the file exists.

<li>
<code>-f file</code>: True if the file exists and is a regular file.

<li>
<code>-d file</code>: True if the file exists and is a directory.

<li>
<code>-r file</code>: True if the file is readable.

<li>
<code>-w file</code>: True if the file is writable.

<li>
<code>-x file</code>: True if the file is executable.

<li>
<code>-s file</code>: True if the file exists and is not empty.

<li>
<code>-L file</code>: True if the file is a symbolic link.

<li>
<code>file1 -nt file2</code>: True if file1 is newer than file2.

<li>
<code>file1 -ot file2</code>: True if file1 is older than file2.

</ul>
<div id="Zsh Scripting-Testing Files and Directories-Common File Test Operators-Example: Check if a Directory Exists"><h4 id="Example: Check if a Directory Exists" class="header"><a href="#Zsh Scripting-Testing Files and Directories-Common File Test Operators-Example: Check if a Directory Exists">Example: Check if a Directory Exists</a></h4></div>

<pre zsh>
DIRECTORY="/path/to/directory"
if [[ -d "$DIRECTORY" ]]; then
    echo "Directory exists."
else
    echo "Directory does not exist."
fi
</pre>

<div id="Zsh Scripting-Testing Files and Directories-Common File Test Operators-Example: Check if a file exists and is readable"><h4 id="Example: Check if a file exists and is readable" class="header"><a href="#Zsh Scripting-Testing Files and Directories-Common File Test Operators-Example: Check if a file exists and is readable">Example: Check if a file exists and is readable</a></h4></div>

<pre zsh>
FILE="/path/to/file"
if [[ -e "$FILE" &amp;&amp; -r "$FILE" ]]; then
    echo "The file exists and is readable."
else
    echo "The file doesn't exist or isn't readable."
fi
</pre>

<div id="Zsh Scripting-Testing Variables and Environment Variables"><h2 id="Testing Variables and Environment Variables" class="header"><a href="#Zsh Scripting-Testing Variables and Environment Variables">Testing Variables and Environment Variables</a></h2></div>

<div id="Zsh Scripting-Testing Variables and Environment Variables-Testing for Emptiness"><h3 id="Testing for Emptiness" class="header"><a href="#Zsh Scripting-Testing Variables and Environment Variables-Testing for Emptiness">Testing for Emptiness</a></h3></div>

<ul>
<li>
<code>-z "$variable"</code>: True if the variable is empty.

<li>
<code>-n "$variable"</code>: True if the variable is non-empty.

</ul>
<div id="Zsh Scripting-Testing Variables and Environment Variables-Testing for Emptiness-Example:"><h4 id="Example:" class="header"><a href="#Zsh Scripting-Testing Variables and Environment Variables-Testing for Emptiness-Example:">Example:</a></h4></div>

<pre zsh>
if [[ -z "$MY_ENV_VAR" ]]; then
    echo "MY_ENV_VAR is empty or not set."
else
    echo "MY_ENV_VAR is: $MY_ENV_VAR"
fi
</pre>

<div id="Zsh Scripting-Testing Variables and Environment Variables-Setting and Exporting Variables"><h3 id="Setting and Exporting Variables" class="header"><a href="#Zsh Scripting-Testing Variables and Environment Variables-Setting and Exporting Variables">Setting and Exporting Variables</a></h3></div>

<ul>
<li>
Local variables: Use <code>local</code> inside functions.

<li>
Environment variables: Use <code>export</code> so they are available to child processes.

</ul>
<div id="Zsh Scripting-Testing Variables and Environment Variables-Setting and Exporting Variables-Example:"><h4 id="Example:" class="header"><a href="#Zsh Scripting-Testing Variables and Environment Variables-Setting and Exporting Variables-Example:">Example:</a></h4></div>

<pre zsh>
# Inside a function:
my_function() {
    local local_var="I am local"
    export GLOBAL_VAR="I am global"
}
</pre>

<div id="Zsh Scripting-Testing Variables and Environment Variables-Combining Conditions"><h3 id="Combining Conditions" class="header"><a href="#Zsh Scripting-Testing Variables and Environment Variables-Combining Conditions">Combining Conditions</a></h3></div>

<p>
You can combine tests using logical operators like &amp;&amp; (and) and || (or):
</p>

<pre zsh>
if [[ -d "$DIRECTORY" &amp;&amp; -w "$DIRECTORY" ]]; then
    echo "Directory exists and is writable."
else
    echo "Directory does not exist or is not writable."
fi
</pre>

<p>
For more complex cases, you might nest conditions or use additional grouping with parentheses inside <code>[[ ... ]]</code>.
</p>

<div id="Zsh Scripting-Case Statement"><h2 id="Case Statement" class="header"><a href="#Zsh Scripting-Case Statement">Case Statement</a></h2></div>

<p>
Sometimes conditionals are simpler with case especially with pattern matching:
</p>

<pre zsh>
read -r choice
case "$choice" in
    [Yy]* )
        echo "User chose yes."
        ;;
    [Nn]* )
        echo "User chose no."
        ;;
    * )
        echo "Please answer yes or no."
        ;;
esac
</pre>

<div id="Zsh Scripting-Putting It All Together: A Sample Script"><h2 id="Putting It All Together: A Sample Script" class="header"><a href="#Zsh Scripting-Putting It All Together: A Sample Script">Putting It All Together: A Sample Script</a></h2></div>

<p>
The following is a sample script that demonstrates several of the above concepts:
</p>

<pre zsh>
#!/usr/bin/env zsh

# Function to check directory and prompt for creation if not exists:
ensure_directory() {
    local dir="$1"   # Get the directory path from the first argument
    
    if [[ -d "$dir" ]]; then
        echo "Directory '$dir' already exists."
        return 0
    fi

    # Ask user for confirmation:
    echo -n "Directory '$dir' does not exist. Create it now? (y/N): "
    read -r user_input
    if [[ "$user_input" != "y" ]]; then
        echo "Operation canceled by user."
        return 1
    fi

    # Create the directory
    mkdir -p "$dir"
    if [[ $? -eq 0 ]]; then
        echo "Directory created successfully."
        return 0
    else
        echo "Failed to create the directory."
        return 1
    fi
}

# Example usage of variable and file tests:
FILE="/tmp/testfile.txt"

if [[ -e "$FILE" ]]; then
    echo "File '$FILE' exists."
else
    echo "File '$FILE' does not exist. Creating file..."
    # Create an empty file:
    touch "$FILE"
fi

# Check an environment variable:
if [[ -z "$MY_ENV_VAR" ]]; then
    echo "MY_ENV_VAR is not set or is empty. Setting it now..."
    export MY_ENV_VAR="default_value"
fi

# Call function to ensure directory exists:
TARGET_DIR="/tmp/my_new_directory"
ensure_directory "$TARGET_DIR" || return 1  # Use 'exit 1' if running as a script, but 'return' when sourcing

echo "Continuing script execution..."
# ... rest of the script ...
</pre>

<div id="Zsh Scripting-Additional Tips"><h2 id="Additional Tips" class="header"><a href="#Zsh Scripting-Additional Tips">Additional Tips</a></h2></div>

<ul>
<li>
<span id="Zsh Scripting-Additional Tips-Quoting"></span><strong id="Quoting">Quoting</strong>: Always quote your variables (e.g., <code>"$var"</code>) in tests to avoid issues with spaces or empty values.

<li>
<span id="Zsh Scripting-Additional Tips-Double vs. Single Brackets"></span><strong id="Double vs. Single Brackets">Double vs. Single Brackets</strong>: Use <code>[[ ... ]]</code> for conditionals in zsh for advanced features such as pattern matching. The old <code>[ ... ]</code> syntax still works but has more quirks.

<li>
<span id="Zsh Scripting-Additional Tips-Error Checking"></span><strong id="Error Checking">Error Checking</strong>: Check command exit statuses (with <code>$?</code>) if you need to make decisions based on prior commands.

<li>
<span id="Zsh Scripting-Additional Tips-Interactive and Non-interactive Modes"></span><strong id="Interactive and Non-interactive Modes">Interactive and Non-interactive Modes</strong>: When sourcing a script vs. executing it, be mindful of using <code>return</code> (for functions or sourced scripts) versus <code>exit</code> (for scripts executed as separate processes).

</ul>
<div id="Conclusion"><h1 id="Conclusion" class="header"><a href="#Conclusion">Conclusion</a></h1></div>

<p>
This study guide has covered:
</p>
<ul>
<li>
Basic syntax of conditionals and functions in zsh.

<li>
File test operators for checking paths and file attributes.

<li>
Variable and environment variable testing.

<li>
Combining conditions and using <code>if/elif/else</code> along with <code>case</code> statements.

<li>
Practical examples that illustrate how to build robust scripts.

</ul>
<p>
Experiment with these examples and tweak them to explore additional features such as arithmetic tests <code>((( ... )))</code> and advanced pattern matching.
</p>




<p>
<a href="unix_tools_index.html">Unix Tools</a>
</p>

<p>
<a href="index.html">index</a>
</p>

</body>
</html>
