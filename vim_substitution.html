<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<title>vim_substitution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<p>
<a href="index.html">index</a>
</p>

<p>
<a href="vim_learning.html">Vim Learning</a>
</p>

<div id="Substitution"><h2 id="Substitution" class="header"><a href="#Substitution">Substitution</a></h2></div>

<p>
<em>NEEDS WORK HERE FOR BASICS AND REGEX</em>
</p>


<div id="Substitution-Replace or Substitute"><h3 id="Replace or Substitute" class="header"><a href="#Substitution-Replace or Substitute">Replace or Substitute</a></h3></div>

<p>
Replace every occurrence <a href="of.html">of</a> 'oldpattern' with 'newpattern' in a buffer:
</p>

<pre>
:%s/oldpattern/newpattern/g
</pre>

<p>
<code>g</code> is 'global', and searches beyond the first occurrence.
</p>

<div id="Substitution-Ask for Confirmation"><h3 id="Ask for Confirmation" class="header"><a href="#Substitution-Ask for Confirmation">Ask for Confirmation</a></h3></div>

<pre>
:%s/old/new/gc
</pre>

<p>
<code>y</code> or <code>n</code> to choose yes or no for each as it cycles through.
</p>

<div id="Substitution-Ask for Confirmation-Single Line"><h4 id="Single Line" class="header"><a href="#Substitution-Ask for Confirmation-Single Line">Single Line</a></h4></div>

<pre>
:s
</pre>

<div id="Substitution-Ask for Confirmation-Whole Buffer"><h4 id="Whole Buffer" class="header"><a href="#Substitution-Ask for Confirmation-Whole Buffer">Whole Buffer</a></h4></div>

<pre>
:%s
</pre>

<div id="Count Number of Matches"><h1 id="Count Number of Matches" class="header"><a href="#Count Number of Matches">Count Number of Matches</a></h1></div>

<pre vim>
:%s/My search pattern//ng
</pre>

<div id="Specific Example (for get_iplayer CSV correction"><h1 id="Specific Example (for get_iplayer CSV correction" class="header"><a href="#Specific Example (for get_iplayer CSV correction">Specific Example (for get_iplayer CSV correction</a></h1></div>

<p>
If a comma is followed by 'space BBC' (", BBC"), keep it and ignore others, but delete any before this pattern is found.
</p>

<p>
We can achieve this using a combination of regular expressions and substitution in vim.
</p>

<p>
Open your file in vim. Enter command mode by pressing <code>:</code>.
</p>

<p>
Use this command:
</p>

<pre vim>
:%s/\(.*\)\(,\sBBC.*\)/\=substitute(submatch(1), ',', '', 'g') . submatch(2)/
</pre>

<div id="Specific Example (for get_iplayer CSV correction-Explanation"><h3 id="Explanation" class="header"><a href="#Specific Example (for get_iplayer CSV correction-Explanation">Explanation</a></h3></div>

<p>
<code>:%s/</code>: This starts a substitution for every line in the file.
</p>

<p>
<code>\(.*\)\(,\sBBC.*\)</code>: This matches any characters <code>(.*)</code> up to the first occurrence of ", BBC", and any characters thereafter. The parentheses () create capturing groups.
</p>

<p>
<code>\=substitute(submatch(1), ',', '', 'g') . submatch(2)</code>: This uses substitute() to remove all commas in the first capturing group (before ", BBC"), then concatenates the result with the second capturing group (", BBC" and subsequent characters). The 'g' stands for 'global', and results in all the commas before the ", BBC" one are replaced.
</p>

<div id="Specific Example (for get_iplayer CSV correction-Explanation-Example"><h4 id="Example" class="header"><a href="#Specific Example (for get_iplayer CSV correction-Explanation-Example">Example</a></h4></div>

<p>
Input: <code>Alexandra Gardens, Cardiff 1, BBC Two, m001rbpj</code>
</p>

<p>
Output: <code>Alexandra Gardens Cardiff 1, BBC Two, m001rbpj</code>
</p>

<p>
This command ensures that the comma before 'BBC' is retained, while any other commas before this pattern are removed.
</p>


<div id="Substitute Only On Matching Lines"><h1 id="Substitute Only On Matching Lines" class="header"><a href="#Substitute Only On Matching Lines">Substitute Only On Matching Lines</a></h1></div>

<p>
This technique will perform substitutions only on lines containing a given search pattern.
</p>

<p>
Premise: If you want to delete lines with a search pattern present, you could do something like <code>g/&lt;pattern&gt;/d</code>. Following this logic, you can substitute on lines which contain a search pattern:
</p>

<p>
<code>g/&lt;pattern&gt;/s/old/new/g</code> --&gt; On lines containing the '&lt;pattern&gt;', replace 'old' with 'new'.
</p>


<div id="Substituting Shell Values"><h1 id="Substituting Shell Values" class="header"><a href="#Substituting Shell Values">Substituting Shell Values</a></h1></div>

<p>
Using shell values inside Vim's <code>:substitute</code> command can be very powerful. Here are a few useful shell values that you can utilize within Vim:
</p>

<ul>
<li>
Home Directory: To substitute a placeholder with your home directory:
<pre vim>
:%s/myhome/\=expand($HOME)/g
</pre>

</ul>
<p>
This will replace "myhome" with your home directory path, such as /Users/YourUsername.
</p>

<ul>
<li>
User Name: To substitute a placeholder with your username:
<pre vim>
:%s/username/\=expand($USER)/g
</pre>

</ul>
<p>
This will replace "username" with your actual username, like YourUsername.
</p>

<ul>
<li>
Current Date and Time: To insert the current date and time, you can use the strftime function:
<pre vim>
:%s/current_time/\=strftime("%c")/g
</pre>

</ul>
<p>
This will replace "current_time" with the current date and time in the format, e.g., Tue Mar 11 17:02:00 2025.
</p>

<ul>
<li>
Current Working Directory: To replace a placeholder with the current working directory:
<pre vim>
:%s/currentdir/\=expand($PWD)/g
</pre>

</ul>
<p>
Similar to the example you provided, this will replace "currentdir" with the current directory path.
</p>

<ul>
<li>
Shell Command Output: To replace a placeholder with the output of a shell command, use the system function. For example, to insert the list of files in the current directory:
<pre vim>
:%s/filelist/\=system('ls')/g
</pre>

</ul>
<p>
This will replace "filelist" with the output of the ls command.
</p>

<ul>
<li>
Environment Variables: To substitute a placeholder with any environment variable value, such as the shell type:
<pre vim>
:%s/myshell/\=expand('$SHELL')/g
</pre>

</ul>
<p>
This will replace "myshell" with the shell type, like /bin/bash.
</p>

<p>
<a href="vim_learning.html">Vim Learning</a>
</p>

<p>
<a href="index.html">index</a>
</p>

</body>
</html>
