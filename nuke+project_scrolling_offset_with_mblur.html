<!DOCTYPE html>
<html>
<head>
<link rel="Stylesheet" type="text/css" href="style.css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<title>nuke+project_scrolling_offset_with_mblur</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>

<p>
<a href="index.html">index</a>
</p>

<p>
<a href="nuke_index.html">Nuke Index</a>
</p>

<div id="LoopCanvas - Scrolling Offset with MotionBlur"><h1 id="LoopCanvas - Scrolling Offset with MotionBlur" class="header"><a href="#LoopCanvas - Scrolling Offset with MotionBlur">LoopCanvas - Scrolling Offset with MotionBlur</a></h1></div>

<p>
This is a group node to offset a canvas/image by a set amount (in x and/or y), and a multiplier to set speed. Feature optional motion blur.
</p>

<p>
Work to do:
</p>
<ul>
<li>
Remove obsolete variables from the overscan expression node (the values come from the group controls).
<pre nuke>
set cut_paste_input [stack 0]
version 15.0 v7
push $cut_paste_input
Group {
 name LoopCanvas
 selected true
 xpos 398
 ypos -40
 addUserKnob {20 user l Motion}
 addUserKnob {3 start_frame l "Start Frame (Frame Offset)" t "Enter the start frame number of your timeline.\n\nSetting this to the start frame will negate any motion on the canvas on that frame.\n\nWhen set, the first frame will appear with a zero offset."}
 start_frame {{root.first_frame}}
 addUserKnob {26 ""}
 addUserKnob {7 speed l "Speed (Offset Multiplier)" t "A value of one will result in the offset being applied per frame.\n\nThis value is a multiplier for motion (Offset) per frame." R 0 10}
 speed 1
 addUserKnob {26 ""}
 addUserKnob {7 offset_x l "Offset X" t "Base Offset in pixels on the x (left/right) axis.\n\nWith Speed set to 1, this will be motion per frame." R 0 100}
 offset_x 10
 addUserKnob {7 offset_y l "Offset Y" t "Base Offset in pixels on the y (up/down) axis.\n\nWith Speed set to 1, this will be motion per frame." R 0 100}
 addUserKnob {26 ""}
 addUserKnob {6 mb l "Motion Blur" t "Apply motion blur" +STARTLINE}
 addUserKnob {7 mb_amount l "Motion Blur Amount" R 0 10}
 mb_amount 1
 addUserKnob {41 offset l "Shutter Offset" T VectorBlur2.offset}
 addUserKnob {20 tech l Tech}
 addUserKnob {26 author l Author: T "Robert Holder"}
 addUserKnob {26 version l Version: T 1.2.0}
 addUserKnob {26 version_history l "" +STARTLINE +INVISIBLE T "1.0.0 - 251015 - Initial Version\n1.1.0 - 251016 - Fixed UV offset, and scaling reformat expression\n1.2.0 - 251017 - Switched STMaps to Impulse filtering (to prevent edge lines)"}
}
 BackdropNode {
  inputs 0
  name BackdropNode1
  tile_color 0x828282ff
  label "Base Canvas\nMotion\nas UV Map"
  note_font "Bitstream Vera Sans Bold"
  note_font_size 42
  xpos -1184
  ypos -67
  bdwidth 547
  bdheight 215
 }
 BackdropNode {
  inputs 0
  name BackdropNode2
  tile_color 0x828282ff
  label "Expand Canvas\nWith Wrapped\nEdges"
  note_font "Bitstream Vera Sans Bold"
  note_font_size 42
  xpos -1182
  ypos 169
  bdwidth 542
  bdheight 307
 }
 BackdropNode {
  inputs 0
  name BackdropNode3
  tile_color 0x828282ff
  label "Directional Blur\nAcross Canvas\n(With Wrapped\nEdges)"
  note_font "Bitstream Vera Sans Bold"
  note_font_size 42
  xpos -1183
  ypos 497
  bdwidth 544
  bdheight 403
 }
 BackdropNode {
  inputs 0
  name BackdropNode4
  tile_color 0x828282ff
  label "Motion Blur\non/off"
  note_font "Bitstream Vera Sans Bold"
  note_font_size 42
  xpos -1183
  ypos 1154
  bdwidth 539
  bdheight 222
 }
 BackdropNode {
  inputs 0
  name BackdropNode5
  tile_color 0x828282ff
  label "Remove Wrapped\nEdges"
  note_font "Bitstream Vera Sans Bold"
  note_font_size 42
  xpos -1182
  ypos 918
  bdwidth 539
  bdheight 222
 }
 Constant {
  inputs 0
  channels rgb
  color {{"parent.offset_x * parent.speed"} {"parent.offset_y * parent.speed"} 0 0}
  name Constant13
  xpos -1031
  ypos 713
 }
 Input {
  inputs 0
  name Input
  xpos -807
  ypos -118
 }
 Dot {
  name Dot5
  xpos -773
  ypos 15
 }
set N3ff7ca0 [stack 0]
 Dot {
  name Dot6
  xpos -883
  ypos 15
 }
 Expression {
  temp_name0 posx
  temp_expr0 "(x - offset_total.x + 0.5)/width"
  temp_name1 posy
  temp_expr1 "(y - offset_total.y + 0.5)/height"
  expr0 posx-floor(posx)
  expr1 posy-floor(posy)
  expr2 0
  expr3 0
  name Expression1
  xpos -917
  ypos 66
  addUserKnob {20 User}
  addUserKnob {12 offset_total l "Offset Total"}
  offset_total {{"offset_x * (frame - parent.start_frame) * parent.speed"} {"offset_y * (frame - parent.start_frame) * parent.speed"}}
 }
 Dot {
  name Dot8
  xpos -883
  ypos 118
 }
push $N3ff7ca0
 STMap {
  inputs 2
  uv rgb
  filter impulse
  name STMap2
  xpos -807
  ypos 108
 }
 Dot {
  name Dot3
  xpos -773
  ypos 317
 }
set N3ff82120 [stack 0]
 Dot {
  name Dot2
  xpos -882
  ypos 317
 }
set N3f884750 [stack 0]
 Dot {
  name Dot4
  xpos -997
  ypos 317
 }
 Reformat {
  type scale
  scale {{"(abs(offset_x * speed))/width + 1 &gt; 1.4 ? 1.4 : (abs(offset_x * speed))/width + 1"} {"(abs(offset_y * speed))/width + 1 &gt; 1.4 ? 1.4 : (abs(offset_y * speed))/width + 1"}}
  resize none
  center false
  name Reformat_expand
  xpos -1031
  ypos 350
 }
 Expression {
  temp_name0 orig_width
  temp_expr0 parent.Input.width
  temp_name1 orig_height
  temp_expr1 parent.Input.height
  temp_name2 offset_x
  temp_expr2 "(orig_width - width) / 2"
  temp_name3 offset_y
  temp_expr3 "(orig_height - height) / 2"
  expr0 "(((x + 0.5) + offset_x) - floor(((x + 0.5) + offset_x) / orig_width) * orig_width) / orig_width"
  expr1 "(((y + 0.5) + offset_y) - floor(((y + 0.5) + offset_y) / orig_height) * orig_height) / orig_height"
  expr2 0
  expr3 0
  name Expression2
  xpos -1031
  ypos 390
 }
 Dot {
  name Dot7
  xpos -997
  ypos 429
 }
push $N3f884750
 STMap {
  inputs 2
  uv rgb
  filter impulse
  name STMap3
  xpos -916
  ypos 419
 }
set N964a740 [stack 0]
 Shuffle2 {
  inputs 2
  fromInput1 {{0} B A}
  fromInput2 {{1} B A}
  in2 rgb
  out2 forward
  mappings "6 rgba.red 0 0 rgba.red 0 0 rgba.green 0 1 rgba.green 0 1 rgba.blue 0 2 rgba.blue 0 2 rgba.alpha 0 3 rgba.alpha 0 3 rgba.red 1 0 forward.u 1 0 rgba.green 1 1 forward.v 1 1"
  name Shuffle67
  xpos -916
  ypos 736
 }
 VectorBlur2 {
  uv forward
  scale {{"parent.mb_amount * 5"}}
  motion_falloff 0.07999999821
  grow_bbox 2.5
  normalize false
  name VectorBlur2
  xpos -916
  ypos 762
 }
 Reformat {
  type scale
  scale {{1/parent.Reformat_expand.scale} {1/parent.Reformat_expand.scale}}
  resize none
  name Reformat_contract
  label "Invert Initial\nCanvas Scaling"
  note_font "Bitstream Vera Sans Bold"
  xpos -916
  ypos 1049
 }
 Dot {
  name Dot1
  xpos -882
  ypos 1336
 }
push $N3ff82120
 Switch {
  inputs 2
  which {{parent.mb}}
  name Switch1
  xpos -807
  ypos 1332
 }
 Output {
  name Output1
  xpos -807
  ypos 1441
 }
 StickyNote {
  inputs 0
  name StickyNote1
  tile_color 0x9c9c9cff
  label "Reformat to original size  --&gt;\n(removing wrapped edges)"
  note_font "Bitstream Vera Sans Bold"
  xpos -1107
  ypos 1053
 }
push $N964a740
end_group
</pre>

</ul>
<p>
<a href="nuke_index.html">Nuke Index</a>
</p>

<p>
<a href="index.html">index</a>
</p>

</body>
</html>
